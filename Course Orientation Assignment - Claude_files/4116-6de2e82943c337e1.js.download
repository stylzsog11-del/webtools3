try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},i=(new e.Error).stack;i&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[i]="9fca740f-7011-482b-8fb1-ef25a71e6059",e._sentryDebugIdIdentifier="sentry-dbid-9fca740f-7011-482b-8fb1-ef25a71e6059")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4116],{15070:(e,i,n)=>{n.d(i,{b:()=>r});var t=n(65631),a=n(7620),u=n(1761);function r(e){let{account:i,activeOrganization:n}=(0,u.YL)();return(0,a.useMemo)(()=>(0,t.yI)(i,n,e),[i,n,e])}},25109:(e,i,n)=>{n.d(i,{G6:()=>o,dD:()=>s,dd:()=>r,mk:()=>c,uv:()=>d,vm:()=>l});var t=n(1761),a=n(27062),u=n(7620);let r=()=>{let{value:e}=(0,a.fS)("c4w_contracted_shebang"),{value:i}=(0,a.fS)("c4w_self_serve_shebang"),{activeOrganization:n}=(0,t.YL)(),r=null==n?void 0:n.billing_type;return(0,u.useMemo)(()=>(!!e||!!i)&&("stripe_subscription_contracted"===r?e:(!r||"none"===r||"stripe_subscription"===r)&&i),[e,i,r])},l=(e,i)=>{if(i){if("enterprise_standard"===e||"c4e_standard_seat"===e||"standard"===e)return"c4e_standard_seat";if("enterprise_tier_1"===e||"c4e_tier_1_seat"===e||"tier_1"===e)return"c4e_tier_1_seat";if("enterprise_tier_2"===e||"c4e_tier_2_seat"===e||"tier_2"===e)return"c4e_tier_2_seat"}else{if("team_standard"===e||"team_plan_standard_seat"===e||"standard"===e)return"team_plan_standard_seat";if("team_tier_1"===e||"team_plan_tier_1_seat"===e||"tier_1"===e)return"team_plan_tier_1_seat"}return null},s=(e,i)=>{if(!(null==e?void 0:e.seat_tier_quantities))return[];let n=[],t=new Set;Object.entries(e.seat_tier_quantities).forEach(e=>{let[a,u]=e,r=l(a,i);"c4e_tier_2_seat"!==r&&"unassigned"!==a&&r&&"number"==typeof u&&(n.push({itemType:r,currentSeats:u,adjustedSeats:u}),t.add(r))});let a=i?"c4e_standard_seat":"team_plan_standard_seat",u=i?"c4e_tier_1_seat":"team_plan_tier_1_seat";return t.has(a)||n.push({itemType:a,currentSeats:0,adjustedSeats:0}),t.has(u)||n.push({itemType:u,currentSeats:0,adjustedSeats:0}),n},o=(e,i,n,t)=>{let a=[...e];if(t){if("unassigned"!==n){let e=l(n,t);if(e){let i=a.find(i=>i.itemType===e);i?i.adjustedSeats+=1:a.push({itemType:e,currentSeats:0,adjustedSeats:1})}}}else{if("unassigned"!==i&&"unassigned"!==n){let e=l(i,t);if(e){let i=a.find(i=>i.itemType===e);i&&i.adjustedSeats>0&&(i.adjustedSeats-=1)}}if("unassigned"!==n){let e=l(n,t);if(e){let i=a.find(i=>i.itemType===e);i?i.adjustedSeats+=1:a.push({itemType:e,currentSeats:0,adjustedSeats:1})}}}return a},d=e=>{if(!(null==e?void 0:e.seat_tier_quantities))return 0;let i=Object.entries(e.seat_tier_quantities).filter(e=>{let[i]=e;return"enterprise_tier_2"===i||"c4e_tier_2_seat"===i||"tier_2"===i});if(i.length>0){let e=i[0][1];return"number"==typeof e?e:0}return 0},c=(e,i)=>{if("unassigned"===i&&"unassigned"!==e)return!0;if("unassigned"===e)return!1;let n=e.includes("tier_1")||e.includes("premium"),t=i.includes("standard")&&!i.includes("tier_1")&&!i.includes("premium");return!!n&&!!t}},34116:(e,i,n)=>{n.d(i,{$0:()=>w,C:()=>W,Cm:()=>el,Ew:()=>Y,Gs:()=>H,Jh:()=>f,L3:()=>x,Le:()=>b,N_:()=>er,Nb:()=>q,PI:()=>ea,PQ:()=>Q,Pz:()=>g,Qn:()=>D,SR:()=>Z,Si:()=>eu,UK:()=>ee,Uu:()=>V,V9:()=>R,VK:()=>A,Xi:()=>O,Xt:()=>h,ZA:()=>j,Zr:()=>S,_D:()=>ei,a1:()=>I,bE:()=>B,bF:()=>k,bt:()=>P,c:()=>G,cR:()=>$,cg:()=>C,e0:()=>z,fS:()=>et,ib:()=>ec,jH:()=>es,jN:()=>T,k0:()=>L,kg:()=>F,lG:()=>U,ls:()=>ey,mU:()=>ev,nc:()=>K,p$:()=>ed,rB:()=>en,sd:()=>N,uS:()=>X,wu:()=>J,xy:()=>eo,yS:()=>E});var t=n(77186),a=n(1761),u=n(51121),r=n(15070),l=n(29585),s=n(71473),o=n(65631),d=n(87606),c=n(7620),y=n(95751),v=n(92249),_=n(38728),p=n(92075),m=n(40459);function g(e){let{onSuccess:i,onError:n}=e,{activeOrganization:u}=(0,a.YL)(),{data:r,variables:l,...s}=(0,t.L2)("/api/billing/".concat(null==u?void 0:u.uuid,"/consumer_pricing"),"POST",{enabled:!!u,meta:{noToast:!0},onError:n,onSuccess:i}),[o,d]=(0,c.useState)(),[y,v]=(0,c.useState)();return(0,c.useEffect)(()=>{r&&(d(r),v(l))},[r,l]),{data:o,variables:y,...s}}function f(e){let{onError:i}=e,{activeOrganization:n}=(0,a.YL)(),{data:u,variables:r,...l}=(0,t.L2)("/api/billing/".concat(null==n?void 0:n.uuid,"/cw_pricing"),"POST",{enabled:!!n,meta:{noToast:!0},onError:i}),[s,o]=(0,c.useState)(),[d,y]=(0,c.useState)();return(0,c.useEffect)(()=>{u&&(o(u),y(r))},[u,r]),{data:s,variables:d,...l}}function b(){var e,i,n,u;let{perBillingPeriod:r,onSuccess:l,onError:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:o}=(0,a.YL)(),[d,v]=(0,c.useState)(null),[_,p]=(0,c.useState)(),{data:m,isPending:g,error:f,mutate:b}=(0,t.L2)("/api/billing/".concat(null==o?void 0:o.uuid,"/individual_plan_pricing/v2"),"POST",{enabled:!!o,meta:{noToast:!0},onError:s,onSuccess:l});(0,c.useEffect)(()=>{m&&p(m)},[m]);let S=_||m,Q=S&&{country:S.country,currency:S.currency,price:r?null==(e=S.product_prices_per_billing_period)?void 0:e.max_5x_monthly:null==(i=S.product_prices_due_today)?void 0:i.max_5x_monthly,planType:y.un.FIVE_X};return{fiveXPricing:Q,twentyXPricing:S&&{country:S.country,currency:S.currency,price:r?null==(n=S.product_prices_per_billing_period)?void 0:n.max_20x_monthly:null==(u=S.product_prices_due_today)?void 0:u.max_20x_monthly,planType:y.un.TWENTY_X},isPending:g,error:f,fetchAllPricing:(0,c.useCallback)(e=>{v(e),e.noCache&&p(void 0),b(e)},[b]),addressParams:d}}let S=()=>{let{activeOrganization:e}=(0,a.YL)();return(0,t.Sk)("/api/billing/".concat(null==e?void 0:e.uuid,"/reset_pricing"),{enabled:!!e,meta:{noToast:!0}})},Q=()=>{let{activeOrganization:e}=(0,a.YL)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription"),"PUT",{enabled:!!e})},q=()=>{let{activeOrganization:e}=(0,a.YL)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription/verify-payment"),"POST",{enabled:!!e})},h=()=>{let{activeOrganization:e}=(0,a.YL)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription/cw"),"PUT",{enabled:!!e})},L=()=>{let{activeOrganization:e}=(0,a.YL)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/rate_limit_reset"),"POST",{enabled:!!e})};function K(){let{activeOrganization:e}=(0,a.YL)();return(0,t.Sk)("/api/organizations/".concat(null==e?void 0:e.uuid,"/payment_method"),{enabled:!!e,queryKey:["payment-method",null==e?void 0:e.uuid],staleTime:9e5})}function T(e){var i;let{activeOrganization:n}=(0,a.YL)(),u=(0,a.h0)();return(0,t.Sk)("/api/organizations/".concat(null==n?void 0:n.uuid,"/subscription_details"),{queryKey:[s.Gn,null==n?void 0:n.uuid],staleTime:0,initialData:null==e?void 0:e.initialData,refetchOnMount:null==e||!e.forceRefetch||"always",enabled:!!n&&u&&(null==(i=null==e?void 0:e.enabled)||i),meta:{noToast:e=>e instanceof l.LG&&404===e.statusCode}})}function w(e){var i;let{activeOrganization:n}=(0,a.YL)();return(0,t.Sk)("/api/organizations/".concat(null==n?void 0:n.uuid,"/paused_subscription_details"),{queryKey:[s.dZ,null==n?void 0:n.uuid],enabled:!!n&&(null==(i=null==e?void 0:e.enabled)||i),meta:{noToast:e=>e instanceof l.LG&&404===e.statusCode}})}function Y(e){var i;let{activeOrganization:n}=(0,a.YL)();return(0,t.Sk)("/api/organizations/".concat(null==n?void 0:n.uuid,"/trial_status"),{queryKey:[s.nb,null==n?void 0:n.uuid],enabled:!!n&&(null==(i=null==e?void 0:e.enabled)||i),meta:{noToast:e=>e instanceof l.LG&&404===e.statusCode}})}function P(){let{activeOrganization:e}=(0,a.YL)(),i=(0,d.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/acknowledge_trial_end"),"POST",{enabled:!!e,meta:{noToast:!0},onSuccess:()=>{i.setQueryData([s.nb,null==e?void 0:e.uuid],e=>{if(e)return{...e,trial_end_requires_action:!1}})}})}let z=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{addError:t}=(0,u.Y)(),a=(0,d.useQueryClient)(),r=(0,v.UV)(e,{...n,async onSuccess(u,l,o){var d;if("payment_intent_client_secret"in u){let e=await i;return e?(await e.confirmPayment({clientSecret:u.payment_intent_client_secret,redirect:"if_required"})).error?void t("Payment confirmation failed. Please try again."):void r.mutate(l):void t("Stripe failed to initialize. Please try again.")}a.invalidateQueries({queryKey:[s.MJ,e]}),a.invalidateQueries({queryKey:[s._S,e]}),await (null==(d=n.onSuccess)?void 0:d.call(n,u,l,o))}});return r},U=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{addError:t}=(0,u.Y)(),a=(0,d.useQueryClient)(),r=(0,v.tH)(e,{...n,async onSuccess(u,l,o){var d;if("payment_intent_client_secret"in u){let e=await i;return e?(await e.confirmPayment({clientSecret:u.payment_intent_client_secret,redirect:"if_required"})).error?void t("Payment confirmation failed. Please try again."):void r.mutate(l):void t("Stripe failed to initialize. Please try again.")}a.invalidateQueries({queryKey:[s.MJ,e]}),a.invalidateQueries({queryKey:[s._S,e]}),await (null==(d=n.onSuccess)?void 0:d.call(n,u,l,o))}});return r};function M(){let{activeOrganization:e}=(0,a.YL)(),i=(0,a.mV)();return m.env.NEXT_PUBLIC_DISABLE_PAYMENTS?{data:{status:"active",cancel_at_ts:null},isLoading:!1}:(0,t.Sk)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription_status"),{queryKey:[s._S,null==e?void 0:e.uuid],staleTime:0,enabled:!!e&&i,meta:{noToast:e=>e instanceof l.LG&&404===e.statusCode}})}function C(){let{data:e,isLoading:i}=M();return{isRavenTrialing:(null==e?void 0:e.status)==="trialing",isLoading:i}}function k(){let{data:e,isLoading:i}=M();return{isRavenCanceled:(null==e?void 0:e.status)==="canceled"||(null==e?void 0:e.status)==="unpaid",isLoading:i}}function D(){let{data:e,isLoading:i}=M();return{isRavenPastDue:(null==e?void 0:e.status)==="past_due",isLoading:i}}function G(){let{data:e,isLoading:i}=M();return{isRavenPendingCancellation:!!(null==e?void 0:e.cancel_at_ts),isLoading:i}}function E(){let{activeOrganization:e}=(0,a.YL)(),{isRavenCanceled:i,isLoading:n}=k(),{isRavenPastDue:t,isLoading:u}=D(),r=n||u,l=(null==e?void 0:e.billing_type)==="stripe_subscription_contracted";return{isLoading:r,canManageMembers:!r&&!i&&(l||!t)}}function O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/end_subscription"),"PUT",{...e,onSuccess(i,t,a){var r;n.setQueryData([s.Gn,u],e=>{if(e)return{...e,plan_ending_before:"".concat(i.plan_ends_at,"T00:00:00+00:00")}}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),n.invalidateQueries({queryKey:[s.Gn,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(n,"/cancellation_survey"),"POST",{...e,enabled:!!i})}function I(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/resume_subscription"),"PUT",{...e,onSuccess(i,t,a){var r;n.setQueryData([s.Gn,u],e=>{if(e)return{...e,plan_ending_before:null}}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function J(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(null==i?void 0:i.uuid,"/renew_subscription/cw"),"PUT",{...e,onSuccess(t,a,u){var r;t.clientSecret||(n.invalidateQueries({queryKey:[s.Gn,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[s._S,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[s.cc,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[s.MJ,null==i?void 0:i.uuid]})),null==(r=e.onSuccess)||r.call(e,t,a,u)},enabled:!!i})}function N(e){let{limit:i,createdSince:n,organizationUUID:u,meta:r}=e,{activeOrganization:l}=(0,a.YL)(),o=Math.round(n.toSeconds()),d=u||(null==l?void 0:l.uuid);return(0,t.Sk)("/api/stripe/".concat(d,"/invoices?limit=").concat(i,"&created_since_ts=").concat(o),{queryKey:[s.cc,d,{limit:i,created_since_ts:o}],staleTime:0,enabled:!!d,meta:r})}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,a.mV)();return(0,t.Sk)("/api/stripe/".concat(null==i?void 0:i.uuid,"/upcoming_invoice"),{queryKey:[s.MJ,null==i?void 0:i.uuid],staleTime:0,enabled:!!i&&n,meta:{noToast:e=>e instanceof l.LG&&500===e.statusCode},...e})}function j(){let{activeOrganization:e}=(0,a.YL)(),i=(0,d.useQueryClient)(),n=null==e?void 0:e.uuid;return(0,t.L2)("/api/organizations/".concat(n,"/payment_method/update_latest"),"POST",{onSuccess:async e=>{let t=i.getQueryData([s.Gn,n]);t&&e?i.setQueryData([s.Gn,n],{...t,payment_method:{...e}}):await i.invalidateQueries({queryKey:[s.Gn,n]}),i.invalidateQueries({queryKey:[s._S,n]}),i.invalidateQueries({queryKey:[s.cc,n]})},meta:{noToast:!0}})}let Z=5,R=150;function V(){let{data:e,isLoading:i}=(0,_.Nk)(),{data:n,isLoading:t}=(0,v.of)(),u=(0,r.b)(o.Nt.MembersManage),l=(0,r.b)(o.Nt.BillingView),{data:s}=(0,p.U6)(),{data:d}=T({enabled:l}),y=(0,a.zm)(),m=es(),g=i||t||!e||!n||!s,f=g?0:e.length,b=g?0:n.filter(e=>"pending"===e.status).length,S=f+b,Q=Math.max(f+b,Z),q=g?0:y?s.members_limit-S:Math.max(Z-S,0),h=(0,c.useMemo)(()=>g||!s?null:(null==d?void 0:d.seat_tier_quantities)||s.seat_tier_quantities,[g,s,d]),L=(0,c.useMemo)(()=>!g&&e&&n?Object.fromEntries((m||[]).map(i=>{var t;let a=null!=(t=null==h?void 0:h[i])?t:0,u=e.filter(e=>e.seat_tier===i).length,r=n.filter(e=>e.seat_tier===i&&"pending"===e.status).length;return[i,a-(u+r)]})):Object.fromEntries((m||[]).map(e=>[e,0])),[g,e,n,m,h]);return g?{isLoading:g,hasManageMembersPermission:u,totalMembersWithoutMinimumApplied:0,totalMembersWithMinimumApplied:0,activeMembers:0,invitedMembers:0,unclaimedMembers:0,minimumApplied:!1,memberLimit:0,isUnlimited:!1,unclaimedSeatsByTier:L}:{isLoading:g,hasManageMembersPermission:u,totalMembersWithoutMinimumApplied:S,totalMembersWithMinimumApplied:Q,activeMembers:f,invitedMembers:b,unclaimedMembers:q,minimumApplied:S<Z,memberLimit:s.members_limit,isUnlimited:s.unlimited_members||!1,unclaimedSeatsByTier:L}}function X(){var e;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,a.YL)(),u="/api/organizations/".concat(null!=(e=null==n?void 0:n.uuid)?e:"","/profile"),r=(0,d.useQueryClient)();return(0,t.L2)(u,"PUT",{...i,async onSuccess(){for(var e,n=arguments.length,t=Array(n),a=0;a<n;a++)t[a]=arguments[a];await r.invalidateQueries({queryKey:[s.Oi]}),await (null==(e=i.onSuccess)?void 0:e.call(i,...t))}})}let B=()=>{let{activeOrganization:e}=(0,a.YL)(),i=(0,r.b)(o.Nt.BillingView);return(0,t.Sk)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription/scheduled_seat_tier_changes"),{enabled:!!e&&i,queryKey:[s.pT,null==e?void 0:e.uuid]})},F=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(null==i?void 0:i.uuid,"/subscription/cancel_scheduled_seat_tier_changes"),"PUT",{...e,onSuccess:function(){for(var t,a=arguments.length,u=Array(a),r=0;r<a;r++)u[r]=arguments[r];n.invalidateQueries({queryKey:[s.pT,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[s.Gn,null==i?void 0:i.uuid]}),null==(t=e.onSuccess)||t.call(e,...u)}})};function W(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/pro/upgrade_to_yearly"),"PUT",{...e,onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s.cc,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function H(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/team/upgrade_to_annual"),"PUT",{...e,onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s.cc,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function $(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/pro/switch_billing_interval"),"PUT",{...e,onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s.Oi,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/upgrade_to_max"),"PUT",{...e,transformVariables:e=>({max_tier:e.maxTier,promo_code:e.promoCode}),onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s.cc,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function ei(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/downgrade_individual_claude_subscription"),"PUT",{...e,onSuccess(i,t,a){var r;if(i.downgrade_timestamp){let e=new Date(1e3*i.downgrade_timestamp).toISOString();n.setQueryData([s.Gn,u],i=>{if(i)return{...i,scheduled_downgrade:{base_price_in_minor_units:0,billing_interval:t.target_plan_type.includes("annual")?"yearly":"monthly",currency:"USD",date:e,plan_type:t.target_plan_type},has_schedule:!0}})}n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function en(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/cancel_subscription_downgrade"),"PUT",{...e,onSuccess(i,t,a){var r;n.setQueryData([s.Gn,u],e=>{if(e)return{...e,scheduled_downgrade:void 0,has_schedule:!1}}),n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s._S,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function et(e){let{activeOrganization:i}=(0,a.YL)();return(0,t.Sk)("/api/stripe/".concat(null==i?void 0:i.uuid,"/balance"),{queryKey:["stripe-balance",null==i?void 0:i.uuid],staleTime:18e5,enabled:!!i,...e})}function ea(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{activeOrganization:i}=(0,a.YL)(),n=null==i?void 0:i.uuid;return(0,t.Sk)("/api/organizations/".concat(n,"/check_3ds_required"),{enabled:e&&!!i,queryKey:["check-3ds-required",n],meta:{noToast:!0},staleTime:864e5,refetchOnWindowFocus:!1,refetchOnMount:!1})}function eu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/verify_payment_method_3ds"),"POST",{...e,onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:["check-3ds-required",u]}),n.invalidateQueries({queryKey:[s.Gn,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function er(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{activeOrganization:i}=(0,a.YL)(),n=null==i?void 0:i.uuid;return(0,t.Sk)("/api/organizations/".concat(n,"/retention_coupon_eligibility"),{enabled:e&&!!i,queryKey:["retention-coupon-eligibility",n],meta:{noToast:!0},staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!0})}function el(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/redeem_retention_coupon"),"POST",{...e,onSuccess(i,t,a){var r;i.success&&(n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s.MJ,u]})),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}let es=()=>{var e;let i=(0,r.b)(o.Nt.BillingManage),n=(0,r.b)(o.Nt.BillingView),t=i&&n,{data:a}=T({enabled:t});if(!t||!a)return[];let u=Object.keys(null!=(e=null==a?void 0:a.seat_tier_quantities)?e:{});return(u.includes("unassigned")?u:[...u,"unassigned"]).filter(e=>"enterprise_tier_2"!==e)},eo=()=>{let e=es();return o.uK.filter(e=>"enterprise_tier_2"!==e).some(i=>e.includes(i))};function ed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/pause_subscription"),"PUT",{...e,onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function ec(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/unpause_subscription"),"PUT",{...e,onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s._S,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s.dZ,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}function ey(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(n,"/subscription/preview_seat_purchase"),"POST",{...e,enabled:!!i})}let ev=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{addError:n}=(0,u.Y)(),{activeOrganization:r}=(0,a.YL)(),l=(0,d.useQueryClient)(),o=null==r?void 0:r.uuid;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=(0,d.useQueryClient)(),u=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(u,"/subscription/purchase_seats"),"POST",{...e,onSuccess(i,t,a){var r;n.invalidateQueries({queryKey:[s.Gn,u]}),n.invalidateQueries({queryKey:[s.MJ,u]}),n.invalidateQueries({queryKey:[s._S,u]}),null==(r=e.onSuccess)||r.call(e,i,t,a)},enabled:!!i})}({...i,async onSuccess(t,a,u){var r,d,c,y;if(t.client_secret){let r=await e;if(!r){n("Stripe failed to initialize. Please try again."),null==(c=i.onError)||c.call(i,Error("Stripe failed to initialize. Please try again."),a,u);return}if((await r.confirmPayment({clientSecret:t.client_secret,redirect:"if_required"})).error){n("Payment confirmation failed. Please try again."),null==(y=i.onError)||y.call(i,Error("Payment confirmation failed. Please try again."),a,u);return}l.invalidateQueries({queryKey:[s.Gn,o]}),l.invalidateQueries({queryKey:[s.MJ,o]}),l.invalidateQueries({queryKey:[s._S,o]}),await (null==(d=i.onSuccess)?void 0:d.call(i,t,a,u));return}l.invalidateQueries({queryKey:[s.Gn,o]}),l.invalidateQueries({queryKey:[s.MJ,o]}),l.invalidateQueries({queryKey:[s._S,o]}),await (null==(r=i.onSuccess)?void 0:r.call(i,t,a,u))}})}},38728:(e,i,n)=>{n.d(i,{Nk:()=>y,bf:()=>p,fp:()=>m,y0:()=>v});var t=n(77186),a=n(1761),u=n(51121),r=n(29585),l=n(71473),s=n(87606),o=n(7620),d=n(25109);let c=function(){var e;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",{activeOrganization:n}=(0,a.YL)(),u=new URLSearchParams;"owners_admins"===i&&(u.append("roles[]","owner"),u.append("roles[]","primary_owner"),u.append("roles[]","membership_admin"));let r=u.toString(),s="/api/organizations/".concat(null!=(e=null==n?void 0:n.uuid)?e:"","/members").concat(r?"?".concat(r):"");return(0,t.Sk)(s,{enabled:!!(null==n?void 0:n.uuid)&&(n.capabilities.includes("api")||n.capabilities.includes("raven")),queryKey:[l.si,{orgUUID:null==n?void 0:n.uuid,roleFilter:i}],staleTime:0})},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=c(e),n=(0,d.dd)(),t=(0,a.zm)(),u=(0,o.useMemo)(()=>{if(!n||!i.data)return i.data;let e=t?"enterprise_standard":"team_standard";return i.data.map(i=>({...i,seat_tier:i.seat_tier||e}))},[n,i.data,t]);return{...i,data:u}},v=function(e){var i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:u}=(0,a.YL)(),r=(0,s.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(null!=(i=null==u?void 0:u.uuid)?i:"","/members/").concat(e),"PUT",{...n,meta:{errorMessage:"There was an error updating the user.",...n.meta},async onSuccess(){for(var e,i=arguments.length,t=Array(i),a=0;a<i;a++)t[a]=arguments[a];await Promise.all([r.invalidateQueries({queryKey:[l.si,{orgUUID:null==u?void 0:u.uuid}]}),r.invalidateQueries({queryKey:[l.ZD,{orgUUID:null==u?void 0:u.uuid}]}),r.invalidateQueries({queryKey:[l.rx]}),r.invalidateQueries({queryKey:[l.cz]})]),await (null==(e=n.onSuccess)?void 0:e.call(n,...t))}})},_=function(){var e;let{offset:i=0,limit:n=30,search:u="",roleFilter:r="all",enabled:s=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:o}=(0,a.YL)(),d=new URLSearchParams({offset:i.toString(),limit:n.toString()});return u&&d.append("search",u),"owners_admins"===r&&(d.append("roles[]","owner"),d.append("roles[]","primary_owner"),d.append("roles[]","membership_admin")),(0,t.Sk)("/api/organizations/".concat(null!=(e=null==o?void 0:o.uuid)?e:"","/members_v2?").concat(d),{enabled:s&&!!(null==o?void 0:o.uuid)&&(o.capabilities.includes("api")||o.capabilities.includes("raven")),queryKey:[l.rx,{orgUUID:null==o?void 0:o.uuid,offset:i,limit:n,search:u,roleFilter:r}],staleTime:0})},p=function(){let{offset:e=0,limit:i=30,search:n="",roleFilter:t="all",enabled:u=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=_({offset:e,limit:i,search:n,roleFilter:t,enabled:u}),l=(0,d.dd)(),s=(0,a.zm)(),c=(0,o.useMemo)(()=>{if(!l||!r.data)return r.data;let e=s?"enterprise_standard":"team_standard";return{...r.data,data:r.data.data.map(i=>"member"===i.type?{...i,member:{...i.member,seat_tier:i.member.seat_tier||e}}:"invite"===i.type?{...i,invite:{...i.invite,seat_tier:i.invite.seat_tier||e}}:i)}},[l,r.data,s]);return{...r,data:c}},m=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,s.useQueryClient)(),{addError:o}=(0,u.Y)(),d="uuid"in i?i.uuid:i.account.uuid,c="email_address"in i?i.email_address:i.account.email_address;return(0,t.L2)("/api/organizations/".concat(e,"/members/").concat(d),"DELETE",{...n,meta:{noToast:!0},async onSuccess(){for(var i,t=arguments.length,u=Array(t),r=0;r<t;r++)u[r]=arguments[r];await a.invalidateQueries({queryKey:[l.si,{orgUUID:e}]}),await a.invalidateQueries({queryKey:[l.rx]}),a.invalidateQueries({queryKey:[l.MJ,e]}),a.invalidateQueries({queryKey:[l._S,e]}),await (null==(i=n.onSuccess)?void 0:i.call(n,...u))},onError(e){var i,n;e instanceof r.LG&&(null==(n=e.extra)||null==(i=n.details)?void 0:i.type)==="seat_minimum_reached"?o("You cannot go below 5 members."):o("There was an error removing ".concat(c," from the organization."))}})}},92075:(e,i,n)=>{n.d(i,{BH:()=>d,NE:()=>_,Nj:()=>l,QY:()=>v,U6:()=>o,VK:()=>p,iD:()=>s,k3:()=>m,q:()=>c,rX:()=>y});var t=n(77186),a=n(1761),u=n(71473),r=n(87606);let l=e=>(0,t.Sk)("/api/organizations/".concat(e),{queryKey:[u.i5,e],enabled:!!e,staleTime:3e4}),s=()=>{let{activeOrganization:e}=(0,a.YL)(),i=null==e?void 0:e.uuid;return(0,t.Qv)(e=>{let{flagType:n}=e;return"/api/organizations/".concat(i,"/flags/").concat(n,"/dismiss")},"POST",(e,i)=>{let{flagType:n}=e;if(i)return{...i,active_flags:i.active_flags.filter(e=>e.type!==n)}},{queryKey:[u.i5,i]})},o=()=>{let{activeOrganization:e}=(0,a.YL)(),i=null==e?void 0:e.uuid;return(0,t.Sk)("/api/organizations/".concat(i,"/members_limit"),{queryKey:[u.hz,i],enabled:!!i,staleTime:0})},d=()=>{let{activeOrganization:e}=(0,a.YL)(),i=null==e?void 0:e.uuid,n=(0,r.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(i,"/contracted_quantity"),"PUT",{enabled:!!i,onSuccess:async()=>{await n.invalidateQueries({queryKey:[u.hz,i]})}})},c=()=>{let{activeOrganization:e}=(0,a.YL)(),i=null==e?void 0:e.uuid;return(0,t.Sk)("/api/organizations/".concat(i,"/public_projects_enabled"),{queryKey:[u._d,i],enabled:!!i,staleTime:0})},y=()=>{let{activeOrganization:e}=(0,a.YL)(),i=null==e?void 0:e.uuid;return(0,t.Sk)("/api/organizations/".concat(i,"/feature_settings"),{queryKey:[u.RR,i],enabled:!!i,staleTime:0})},v=()=>{var e,i;let{activeOrganization:n}=(0,a.YL)(),{data:t}=l(null==n?void 0:n.uuid);return null==(i=null==t||null==(e=t.settings)?void 0:e.claude_ai_completion_feedback_enabled)||i};function _(){var e;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,a.YL)(),l="/api/organizations/".concat(null!=(e=null==n?void 0:n.uuid)?e:""),s=(0,r.useQueryClient)();return(0,t.L2)(l,"PUT",{enabled:!!n,...i,async onSuccess(){for(var e,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];await Promise.all([s.invalidateQueries({queryKey:[u.Rw]}),s.invalidateQueries({queryKey:[u.i5]}),s.invalidateQueries({queryKey:[u.RR,null==n?void 0:n.uuid]})]),await (null==(e=i.onSuccess)?void 0:e.call(i,...a))}})}let p=()=>{let{activeOrganization:e}=(0,a.YL)(),i=null==e?void 0:e.uuid;return(0,t.Sk)("/api/organizations/".concat(i,"/allowed_domains"),{queryKey:[u.OX,i],enabled:!!i})},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,a.YL)(),n=null==i?void 0:i.uuid,l=(0,r.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(n,"/allowed_domains"),"PUT",{enabled:!!n,...e,onSuccess:async function(){for(var i,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];await l.invalidateQueries({queryKey:[u.OX,n]}),await (null==(i=e.onSuccess)?void 0:i.call(e,...a))}})}},92249:(e,i,n)=>{n.d(i,{BF:()=>p,UV:()=>y,oF:()=>_,of:()=>c,tH:()=>v});var t=n(77186),a=n(1761),u=n(51121),r=n(29585),l=n(71473),s=n(87606),o=n(7620),d=n(25109);let c=e=>{let i=(e=>{var i;let{activeOrganization:n}=(0,a.YL)(),u=new URLSearchParams;e&&e.length>0&&e.forEach(e=>u.append("roles[]",e));let r=u.toString(),s="/api/organizations/".concat(null!=(i=null==n?void 0:n.uuid)?i:"","/invites").concat(r?"?".concat(r):"");return(0,t.Sk)(s,{enabled:!!(null==n?void 0:n.uuid)&&(n.capabilities.includes("api")||n.capabilities.includes("raven")),queryKey:[l.ZD,{orgUUID:null==n?void 0:n.uuid,roles:e}],staleTime:0})})(e),n=(0,d.dd)(),{activeOrganization:u}=(0,a.YL)(),r=(0,o.useMemo)(()=>{if(!n||!i.data)return i.data;let e=(null==u?void 0:u.capabilities.includes("commercial_use"))?"enterprise_standard":"team_standard";return i.data.map(i=>({...i,seat_tier:i.seat_tier||e}))},[n,i.data,null==u?void 0:u.capabilities]);return{...i,data:r}},y=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,s.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(e,"/invites"),"POST",{...i,async onSuccess(){for(var t,a=arguments.length,u=Array(a),r=0;r<a;r++)u[r]=arguments[r];await n.invalidateQueries({queryKey:[l.ZD,{orgUUID:e}]}),await n.invalidateQueries({queryKey:[l.rx]}),n.invalidateQueries({queryKey:[l.MJ,e]}),n.invalidateQueries({queryKey:[l._S,e]}),await (null==(t=i.onSuccess)?void 0:t.call(i,...u))}})},v=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,s.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(e,"/invites/bulk"),"POST",{...i,async onSuccess(){for(var t,a=arguments.length,u=Array(a),r=0;r<a;r++)u[r]=arguments[r];await n.invalidateQueries({queryKey:[l.ZD,{orgUUID:e}]}),await n.invalidateQueries({queryKey:[l.rx]}),n.invalidateQueries({queryKey:[l.MJ,e]}),n.invalidateQueries({queryKey:[l._S,e]}),await (null==(t=i.onSuccess)?void 0:t.call(i,...u))}})},_=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,s.useQueryClient)(),{addError:o}=(0,u.Y)();return(0,t.L2)("/api/organizations/".concat(e,"/invites/").concat(i),"DELETE",{...n,meta:{noToast:!0},async onSuccess(){for(var i,t=arguments.length,u=Array(t),r=0;r<t;r++)u[r]=arguments[r];await a.invalidateQueries({queryKey:[l.ZD,{orgUUID:e}]}),await a.invalidateQueries({queryKey:[l.rx]}),a.invalidateQueries({queryKey:[l.MJ,e]}),a.invalidateQueries({queryKey:[l._S,e]}),await (null==(i=n.onSuccess)?void 0:i.call(n,...u))},onError(e){var i,n;e instanceof r.LG&&(null==(n=e.extra)||null==(i=n.details)?void 0:i.type)==="seat_minimum_reached"?o("You cannot go below 5 members."):o("There was an error revoking the invite.")}})},p=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,s.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(e,"/invites/").concat(i),"PUT",{...n,async onSuccess(){for(var i,t=arguments.length,u=Array(t),r=0;r<t;r++)u[r]=arguments[r];await a.invalidateQueries({queryKey:[l.ZD,{orgUUID:e}]}),await a.invalidateQueries({queryKey:[l.rx]}),await (null==(i=n.onSuccess)?void 0:i.call(n,...u))}})}},95751:(e,i,n)=>{n.d(i,{NW:()=>t,un:()=>a});var t=function(e){return e.MONTHLY="monthly",e.YEARLY="yearly",e}({}),a=function(e){return e.FIVE_X="max_5x",e.TWENTY_X="max_20x",e}({})}}]);