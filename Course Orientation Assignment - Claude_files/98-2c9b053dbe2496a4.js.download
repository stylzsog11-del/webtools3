try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="74b6a3f4-eaa0-4511-8c7f-a9fcccc55ea1",e._sentryDebugIdIdentifier="sentry-dbid-74b6a3f4-eaa0-4511-8c7f-a9fcccc55ea1")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{1524:(e,t,n)=>{n.d(t,{R:()=>i});var a=n(1761),r=n(27062);function i(){var e,t;let n=function(){let{value:e}=(0,r.fS)("trials_and_tribulations_of_high_school_football");return e}(),{account:i}=(0,a.YL)(),{value:s}=(0,r.fS)("default_wiggle_on"),o=null!=(t=null==i||null==(e=i.settings)?void 0:e.enabled_monkeys_in_a_barrel)?t:s;return n&&o}},9896:(e,t,n)=>{n.d(t,{F:()=>l});var a=n(27062),r=n(67933),i=n(7620),s=n(77187),o=n(85644);let l=()=>{let e="sticky-model-selector",{value:t}=(0,a.fS)("sticky_model_selector"),{value:n}=(0,a.fS)("model_selector_enabled"),{activeModelOptions:l}=(0,o.A9)(),u=(0,s.Z3)(null),c=(0,r.useQuery)({queryKey:[e],queryFn:()=>{if(!t||!n)return null;let a=localStorage.getItem(e);return a===u?null:a&&l.find(e=>e.model===a)?a:null},initialData:null}),d=(0,i.useCallback)(t=>{t&&localStorage.setItem(e,t),c.refetch()},[c]);return{stickyModelPreference:c.data,setStickyModelPreference:d}}},17423:(e,t,n)=>{n.d(t,{M$:()=>c,O5:()=>o,f$:()=>l,lo:()=>u,n7:()=>d});var a=n(77186),r=n(1761),i=n(71473),s=n(87606);let o=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,a.Sk)("/api/organizations/".concat(t,"/list_styles"),{queryKey:[i.ss,{orgUUID:t}]})},l=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/styles/create"),"POST",{onSuccess:()=>{n.invalidateQueries({queryKey:[i.ss,{orgUUID:t}]})}})},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{activeOrganization:n}=(0,r.YL)(),o=null==n?void 0:n.uuid,l=(0,s.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(o,"/styles/").concat(e,"/edit"),"PUT",{onSuccess:()=>{l.invalidateQueries({queryKey:[i.ss,{orgUUID:o}]})},enabled:!t})},c=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,o=(0,s.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(n,"/styles/").concat(e,"/delete"),"DELETE",{onSuccess:()=>{o.invalidateQueries({queryKey:[i.ss,{orgUUID:n}]})}})},d=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,a.L2)("/api/organizations/".concat(t,"/styles/preview"),"POST")}},22529:(e,t,n)=>{n.d(t,{ClientIntlProvider:()=>m,O:()=>h,X5:()=>g,YX:()=>p,fl:()=>v});var a=n(54568),r=n(55428),i=n(68864),s=n(7620),o=n(88982),l=n(62971),u=n(18483);let c=new Set,d=e=>{if(e.message.includes("MISSING_TRANSLATION")){if(c.has(e.message))return;c.add(e.message)}console.error(e)},f=()=>void 0;function m(e){let{locale:t,messages:n,children:l,hideErrors:u}=e;return(0,s.useEffect)(()=>{i.wB.defaultLocale=t},[t]),(0,a.jsx)(o.A,{locale:t,messages:n,onError:u?f:(0,r.O0)()?d:void 0,fallbackOnEmptyString:!1,children:(0,a.jsx)(a.Fragment,{children:l})})}function p(e){let{id:t}=e;return(0,a.jsx)(l.A,{id:(0,u.ey)(t),defaultMessage:" "})}function g(e){let{id:t}=e;return(0,a.jsx)(l.A,{id:(0,u.lK)(t),defaultMessage:" "})}function v(e){let{id:t,intl:n}=e;return n.formatMessage({id:(0,u.lK)(t),defaultMessage:" "})}function h(e){let{id:t,intl:n}=e;return n.formatMessage({id:(0,u.ey)(t),defaultMessage:" "})}},27630:(e,t,n)=>{n.d(t,{r:()=>a});function a(e,t){return Object.fromEntries(Object.entries(t).map(t=>{let[n,a]=t;return[n.startsWith("".concat(e,"."))?n:"".concat(e,".").concat(n),a]}))}},32442:(e,t,n)=>{function a(e){let t=e,n="",a=0;for(;t!==n&&a<10;)n=t,t=(t=(t=(t=t.normalize("NFKC")).replace(RegExp("[\\p{Cf}\\p{Co}\\p{Cn}]","gu"),"")).replace(RegExp("[\\p{Cc}]","gu"),e=>"\n"===e||"	"===e||"\r"===e?e:"")).replace(/[\u200B-\u200F]/g,"").replace(/[\u202A-\u202E]/g,"").replace(/[\u2066-\u2069]/g,"").replace(/[\uFEFF]/g,"").replace(/[\uE000-\uF8FF]/g,""),a++;if(a>=10)throw Error("Unicode sanitization reached maximum iterations (".concat(10,") for input: ").concat(e.slice(0,100)));return t}n.d(t,{M:()=>function e(t){if("string"==typeof t)return a(t);if(Array.isArray(t))return t.map(e);if(null!==t&&"object"==typeof t){let n={};for(let[a,r]of Object.entries(t))n[e(a)]=e(r);return n}return t},P:()=>a})},42685:(e,t,n)=>{n.d(t,{OpusRateLimitModalProvider:()=>l,T:()=>o});var a=n(54568),r=n(7620),i=n(71165);let s=null;function o(){s&&s(!0)}function l(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>(s=t,()=>{s=null}),[]),(0,a.jsx)(i.v,{isOpen:e,onClose:()=>t(!1),limitType:"opus"})}},45727:(e,t,n)=>{n.d(t,{p:()=>s});var a=n(46127),r=n(27062),i=n(17423);let s=()=>{let{value:e}=(0,r.fS)("concise_mode_enabled"),{data:t,isLoading:n}=(0,i.O5)(),s=(null==t?void 0:t.defaultStyles)||[],o=[...s,...((null==t?void 0:t.customStyles)||[]).map(e=>({...e,key:e.key||e.uuid}))],[l,u,c]=(0,a.Vc)("claude_personalized_style",null);if(n||!(null==o?void 0:o.length))return{personalizedStyleOptions:[],defaultStyle:null,storedStyle:null,setStoredStyle:u,clearStoredStyle:c,conciseModeEnabled:e};let d=s.length?s.find(e=>!0===e.isDefault)||s[0]:null;if(e&&(d=s.find(e=>"Concise"===e.key)||d),!l)return{personalizedStyleOptions:o,defaultStyle:d,storedStyle:l,setStoredStyle:u,clearStoredStyle:c,conciseModeEnabled:e};let f=o.find(e=>((e,t)=>"default"===e.type&&e.key===t||"custom"===e.type&&e.uuid===t)(e,l.styleKey)),m=Date.now()-new Date(l.timestamp).getTime()>432e5;return{personalizedStyleOptions:o,storedStyle:f&&!m?f:null,defaultStyle:d,setStoredStyle:u,clearStoredStyle:c,conciseModeEnabled:e}}},50707:(e,t,n)=>{n.d(t,{M:()=>s});var a=n(54568),r=n(32987),i=n(62971);function s(e){let{className:t,onClick:n,as:s="span"}=e;return(0,a.jsx)(s,{className:(0,r.A)("border-0.5 border-border-400 text-accent-secondary-000 px-1.5 py-px rounded-3xl font-small",n&&"cursor-pointer hover:border-border-300 transition-colors",t),onClick:n,children:(0,a.jsx)(i.A,{defaultMessage:"Upgrade",id:"0h/lPMeYkq"})})}},52909:(e,t,n)=>{n.d(t,{CO:()=>f,M3:()=>u,bG:()=>c,ks:()=>p,pz:()=>l,z_:()=>d});var a=n(77186),r=n(1761),i=n(71473),s=n(87606),o=n(91768);let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid,s=m(),l=(0,o.eL)();return(0,a.L2)(()=>"/api/organizations/".concat(i,"/projects/").concat(e,"/syncs"),"POST",{enabled:!!(n&&e),...t,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];s(e),null==(n=t.onSuccess)||n.call(t,...r)},onError:function(){for(var e,n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];null==(e=t.onError)||e.call(t,...a);let[i,s]=a;l(i,s)}})},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid,s=m();return(0,a.L2)(()=>"/api/organizations/".concat(i,"/projects/").concat(e,"/syncs"),"PUT",{enabled:!!(n&&e),...t,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];s(e),null==(n=t.onSuccess)||n.call(t,...r)}})},c=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,s=m();return(0,a.Qv)(t=>"/api/organizations/".concat(n,"/projects/").concat(e,"/syncs/").concat(t),"DELETE",(e,t)=>t?t.filter(t=>t.uuid!==e):t,{queryKey:[i.LV,{orgUuid:n,projectUuid:e}],enabled:!!t,onSuccess:()=>{s(e)}})},d=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,s=m();return(0,a.Qv)(()=>"/api/organizations/".concat(n,"/projects/").concat(e,"/syncs/delete_many"),"POST",(e,t)=>t?t.filter(t=>!e.sync_source_uuids.includes(t.uuid)):t,{queryKey:[i.LV,{orgUuid:n,projectUuid:e}],enabled:!!t,onSuccess:()=>{s(e)}})},f=function(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{activeOrganization:l}=(0,r.YL)(),u=null==l?void 0:l.uuid,c=(0,s.useQueryClient)(),d=!!(l&&e&&n),{data:f,isLoading:m}=(0,a.Sk)("/api/organizations/".concat(u,"/projects/").concat(e,"/syncs?calculate_size=").concat(null!=t&&t),{queryKey:[i.LV,{orgUuid:u,projectUuid:e,calculateSize:t}],enabled:d,refetchInterval:e=>{var t;return(null==(t=e.state.data)?void 0:t.some(o.z3))?5e3:3e5},structuralSharing:(t,n)=>{let a=void 0!==t&&t.some(o.z3),r=void 0!==n&&n.some(o.z3);return a&&!r&&c.invalidateQueries({queryKey:[i.qz,{orgUuid:u,projectUuid:e}]}),n}});return{data:f,isLoading:!!d&&m}},m=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)();return e=>{n.invalidateQueries({queryKey:[i.LV,{orgUuid:t,projectUuid:e}]}),n.invalidateQueries({queryKey:[i._G,{orgUuid:t,projectUuid:e}]}),n.invalidateQueries({queryKey:[i.qz,{orgUuid:t,projectUuid:e}]})}},p=e=>{let{data:t}=f(e);return!!(null==t?void 0:t.some(o.z3))}},60098:(e,t,n)=>{n.d(t,{_:()=>U,o:()=>E});var a=n(54568),r=n(64683),i=n(16253),s=n(74530),o=n(9896),l=n(77186),u=n(29585),c=n(7620),d=n(13368),f=n(98736),m=n(89836),p=n(98251),g=n(72697),v=n(52909),h=n(1761),y=n(51121),b=n(45727),_=n(42685),x=n(83092),S=n(75973),w=n(35313),C=n(26768),k=n(1524),M=n(72431);let P=c.createContext(null).Provider;var j=n(46127),A=n(32442);let T={type:"doc",content:[{type:"paragraph",content:[]}]},z=c.createContext({attachments:[],files:[],transitionFiles:[],syncSourceUuids:[],isAtMaxNumUploads:!1,model:"",prompt:"",tipTapEditorState:{},projectUuid:void 0,beamChatUuid:void 0,isNewBeamChat:!1,isChatSyncing:!1,personalizedStyle:void 0,isProjectSyncing:!1,isNewConversation:!1,isProjectLocked:!1,isSending:!1,setPrompt:()=>void 0,setTipTapEditorState:()=>void 0,setAttachments:()=>void 0,setFiles:()=>void 0,setSyncSourceUuids:()=>void 0,setModel:()=>Promise.resolve(),setProjectUuid:()=>void 0,setBeamChatUuid:()=>void 0,setIsNewBeamChat:()=>void 0,sendMessage:()=>void 0,sendTransparentMessage:()=>void 0,stopSampling:()=>void 0,pendingConversationSettings:{},conversation:void 0,focusInput:()=>void 0,improvePrompt:()=>void 0,isImprovingPrompt:!1,isFocused:!1,setIsFocused:()=>void 0,promptInputRef:{current:null},willRedirectOnSubmit:!1,hasBlockingWarning:!1,setHasBlockingWarning:()=>void 0,setPersonalizedStyle:()=>void 0,isUploadingDriveSync:!1,isUploadingGithubSync:!1,setIsUploadingDriveSync:()=>void 0,setIsUploadingGithubSync:()=>void 0,includeProfilePreferences:!0,setIncludeProfilePreferences:()=>void 0,isUploadingFile:!1,setIsUploadingFile:()=>void 0,validateMaxUploadLimit:()=>!1,onDrop:()=>void 0,onPasteFiles:()=>Promise.resolve(),handleUpload:()=>Promise.resolve(),uploadInputProps:{type:"",accept:"",onChange:()=>void 0,multiple:!1,"aria-label":""},hasAttachments:!1,isModelSelectorOpen:!1,setIsModelSelectorOpen:()=>void 0,setPendingConversationSettings:()=>void 0,isPromptUnsafe:()=>!1,currentCompassTask:void 0,setCurrentCompassTask:()=>void 0}),E=()=>c.useContext(z),U=e=>{var t,n,E,U,I,L,F;let{onSend:O,willRedirectOnSubmit:D,onCreate:R,onStopSampling:N}=e,Y=(0,c.useRef)(null);Y.current||(Y.current=(0,C.y)()((0,w.eh)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{...((e,t)=>({prompt:"",setPrompt:function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{forceUpdateTiptap:r=!0,unsafe:i=!1}=a;if(e({prompt:n}),!0===r){var s;let e=t().promptInputRef;null==e||null==(s=e.current)||s.setContent(n)}}}))(...t),...((e,t)=>({attachments:[],files:[],syncSourceUuids:[],transitionFiles:void 0,setAttachments:n=>{e({attachments:"function"==typeof n?n(t().attachments):n})},setFiles:n=>{e({files:"function"==typeof n?n(t().files):n})},setSyncSourceUuids:n=>{e({syncSourceUuids:"function"==typeof n?n(t().syncSourceUuids):n})},setTransitionFiles:t=>{e({transitionFiles:t})}}))(...t),...(e=>({model:void 0,projectUuid:void 0,beamChatUuid:void 0,isNewBeamChat:!1,pendingConversationSettings:void 0,conversation:void 0,setModel:t=>e({model:t}),setProjectUuid:t=>e({projectUuid:t}),setBeamChatUuid:t=>e({beamChatUuid:t}),setIsNewBeamChat:t=>e({isNewBeamChat:t}),setPendingConversationSettings:t=>e(e=>({pendingConversationSettings:{...e.pendingConversationSettings,...t}})),setConversation:t=>e({conversation:t})}))(...t),...(e=>({isFocused:!1,isModelSelectorOpen:!1,hasBlockingWarning:!1,personalizedStyle:void 0,includeProfilePreferences:!1,currentCompassTask:void 0,setIsFocused:t=>e({isFocused:t}),setIsModelSelectorOpen:t=>e({isModelSelectorOpen:t}),setHasBlockingWarning:t=>e({hasBlockingWarning:t}),setPersonalizedStyle:t=>e({personalizedStyle:t}),setIncludeProfilePreferences:t=>e({includeProfilePreferences:t}),setCurrentCompassTask:t=>e({currentCompassTask:t})}))(...t),...(e=>({isUploadingFile:!1,isUploadingDriveSync:!1,isUploadingGithubSync:!1,setIsUploadingFile:t=>e({isUploadingFile:t}),setIsUploadingDriveSync:t=>e({isUploadingDriveSync:t}),setIsUploadingGithubSync:t=>e({isUploadingGithubSync:t})}))(...t),...(e=>({isSending:!1,isImprovingPrompt:!1,setIsSending:t=>e({isSending:t}),setIsImprovingPrompt:t=>e({isImprovingPrompt:t})}))(...t),...(()=>({isAtMaxNumUploads:!1,hasAttachments:!1,isChatSyncing:!1,isProjectSyncing:!1,isNewConversation:!1,isProjectLocked:!1,willRedirectOnSubmit:!1}))(...t),...(()=>({sendMessage:void 0,sendTransparentMessage:void 0,stopSampling:void 0,focusInput:void 0,improvePrompt:void 0,validateMaxUploadLimit:void 0,onDrop:void 0,onPasteFiles:void 0,handleUpload:void 0,uploadInputProps:void 0}))(...t),...(e=>({promptInputRef:void 0,setPromptInputRef:t=>e({promptInputRef:t})}))(...t)}})));let K=Y.current,{incognitoModeEnabled:B}=(0,M.S)(),Q=(0,c.useRef)(null);(0,c.useEffect)(()=>{(0,K.getState().setPromptInputRef)(Q)},[K]);let q="conversation"in e,{children:G,projectUuid:V,namespace:W}=e,X=q?e.conversation:void 0,{markMessageSent:J}=(0,x.B)(),H=(0,c.useCallback)(()=>{q&&N&&N()},[N,q]);(e=>{let t=(0,c.useCallback)(t=>{if(e&&!(e=>!!e&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName||"true"===e.getAttribute("contenteditable")||"textbox"===e.getAttribute("role")))(document.activeElement)&&1===t.key.length&&!t.ctrlKey&&!t.altKey&&!t.metaKey){var n;if(!(" "===t.key&&(e=>{if(!e)return!1;let t=e.tagName;return"BUTTON"===t||"SUMMARY"===t||"SELECT"===t||("INPUT"===t?["button","submit","reset","checkbox","radio"].includes(e.type):["button","checkbox","radio","switch","menuitem","menuitemcheckbox","menuitemradio","option"].includes(e.getAttribute("role")||""))})(document.activeElement)))t.preventDefault(),null==(n=e.getEditor())||n.chain().insertContent(t.key).focus().run()}},[e]);(0,c.useEffect)(()=>(document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)),[t])})(Q.current);let{tipTapEditorState:Z,setTipTapEditorText:$,setTipTapEditorJSON:ee,isTipTapEditorStateUnsafe:et,attachments:en,setAttachments:ea,files:er,setFiles:ei,syncSourceUuids:es,setSyncSourceUuids:eo,clear:el}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,a="".concat(n?"".concat(n,":"):"").concat(e),[r,i,o]=(0,j.Vc)("".concat(a,":attachment"),[]),[l,u,d]=(0,j.Vc)("".concat(a,":files"),[]),[f,m,p]=(0,j.Vc)("".concat(a,":syncSourceUuids"),[]),[g,v,h]=(0,j.Vc)("".concat(a,":textInput"),t?{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:t}]}]}:T),y=(0,c.useCallback)(()=>!!g.__ant_unsafe,[g]),b=(0,c.useCallback)((e,t)=>{let n=(0,A.P)(e),a={type:"doc",content:[{type:"paragraph",content:[{type:"text",text:n}]}]};return n.length>0&&t&&(a.__ant_unsafe=!0),v(a),n},[v]);return{attachments:r,setAttachments:i,files:l,setFiles:u,syncSourceUuids:f,setSyncSourceUuids:m,tipTapEditorState:g,setTipTapEditorJSON:(0,c.useCallback)(e=>{let t=(0,s.h0)(e);return t.length>0&&y()&&(e.__ant_unsafe=!0),v(e),t},[v,y]),setTipTapEditorText:b,isTipTapEditorStateUnsafe:y,clear:(0,c.useCallback)(()=>{h(),o(),d(),p()},[o,h,d,p])}}(null!=(n=null==X?void 0:X.id)?n:void 0===V?"new-conversation":"".concat(V,":conversation"),"",W),eu=Z?(0,s.h0)(Z):"";(0,c.useEffect)(()=>{K.getState().setPrompt(eu,{forceUpdateTiptap:!1})},[K,eu]);let ec=(0,d.P)(K,e=>e.prompt),ed=(0,c.useCallback)(e=>{let t=ee(e);K.getState().setPrompt(t,{forceUpdateTiptap:!1})},[ee,K]),ef=(0,c.useCallback)(function(e){let{forceUpdateTiptap:t=!0,unsafe:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=$(e,n);K.getState().setPrompt(a,{forceUpdateTiptap:t,unsafe:n})},[$,K]),em=(0,m.NY)(es),ep=(0,m.qJ)(em),eg=(0,l.B7)(em),ev=en.length+er.length+es.length>=i.XA.maxTotalUploadsPerMessage,{isModelSelectorOpen:eh,isSending:ey,isFocused:eb,isUploadingDriveSync:e_,isUploadingGithubSync:ex,personalizedStyle:eS,includeProfilePreferences:ew,currentCompassTask:eC}=(0,d.P)(K,(0,f.k)(e=>({isModelSelectorOpen:e.isModelSelectorOpen,isSending:e.isSending,isFocused:e.isFocused,isUploadingDriveSync:e.isUploadingDriveSync,isUploadingGithubSync:e.isUploadingGithubSync,personalizedStyle:e.personalizedStyle,includeProfilePreferences:e.includeProfilePreferences,currentCompassTask:e.currentCompassTask}))),ek=K.getState().setIsModelSelectorOpen,eM=K.getState().setIsSending,eP=K.getState().setIsFocused,ej=K.getState().setIsUploadingDriveSync,eA=K.getState().setIsUploadingGithubSync,eT=K.getState().setPersonalizedStyle,ez=K.getState().setIncludeProfilePreferences,eE=K.getState().setCurrentCompassTask,[eU,eI]=c.useState(),{stickyModelPreference:eL}=(0,o.F)(),eF=null!=(I=null!=(U=null!=(E=null==X?void 0:X.model)?E:eU)?U:eL)?I:void 0,[eO,eD]=c.useState(),eR=(0,c.useCallback)(e=>{eD(t=>({...t,...e}))},[]),[eN,eY]=c.useState(V),eK=(0,g.Ah)(),{mutate:eB}=(0,p.nI)(),eQ=(0,c.useCallback)(e=>{eY(e),eK&&e&&eB&&eB({project_uuid:e})},[eK,eB]),eq=(0,v.ks)(eN),{beamUuid:eG}=(0,S.d)(),[eV,eW]=c.useState(eG),[eX,eJ]=c.useState(!1),eH=(0,c.useCallback)(e=>{eW(e),e&&eJ(!1)},[]),eZ=(0,c.useCallback)(e=>{eJ(e),e&&eW(void 0)},[]),[e$,e0]=c.useState(),{storedStyle:e1,defaultStyle:e2}=(0,b.p)();(0,c.useEffect)(()=>{let e=null!=e1?e1:e2;!eS&&e&&eT(e)},[e1,e2,eS,eT]),(0,c.useEffect)(()=>{V&&eN!==V&&eQ(V)},[V,eN,eQ]);let e7="setPersonalizedStyleCallback"in e?e.setPersonalizedStyleCallback:null;(0,c.useEffect)(()=>{e0(void 0),eM(!1)},[null==X?void 0:X.id,eM]),(0,c.useEffect)(()=>{null==e7||e7(eS)},[eS,e7]);let e6=(0,c.useCallback)(async()=>{if(Q.current&&(""!==ec.trim()||0!==en.length||0!==er.length||0!==es.length)){D&&e0([...er]),el(),K.getState().setPrompt("",{forceUpdateTiptap:!1}),D?Q.current.setEditable(!1):Q.current.setContent(""),eM(!0);try{J(),q&&O?(await O({prompt:ec,attachments:en,files:er,syncSources:eg,personalized_style:eS}),eM(!1),e0(void 0)):await R({prompt:ec,attachments:en,files:er,syncSources:eg,model:eF,project_uuid:eN,is_new_beam_chat:eX||void 0,beam_chat_uuid:eV,personalized_style:eS,include_conversation_preferences:ew,is_temporary:B,...eO})}catch(t){var e;if(t instanceof u.LG&&"opus_messages_rate_limit_exceeded"===t.errorCode)(0,_.T)();else throw t;ef(ec),null==(e=Q.current)||e.setContent(ec),ea(en),ei(er),eo(es),Q.current.setEditable(!0),eM(!1),e0(void 0)}}},[eO,en,el,er,ew,q,eF,R,O,eS,eN,ec,ea,ei,ef,eo,es,eg,D,B,K,eM,J,eX,eV]),e5=(0,c.useCallback)(async e=>{if(void 0!==e&&""!==e.trim()&&q){eM(!0);try{O&&(await O({prompt:e,attachments:[],files:[],syncSources:[],personalized_style:eS}),eM(!1))}catch(e){if(e instanceof u.LG&&"opus_messages_rate_limit_exceeded"===e.errorCode)(0,_.T)();else throw e;eM(!1)}}},[q,O,eS,eM]),{streamImprovement:e4,isStreaming:e8}=function(){let{activeOrganization:e}=(0,h.YL)(),[t,n]=(0,c.useState)(!1),[a,r]=(0,c.useState)(null),i=(0,c.useRef)(null),{addError:s}=(0,y.Y)(),o=(0,c.useCallback)(async(t,a,o,l)=>{i.current&&i.current.abort();let u=new AbortController;i.current=u,n(!0),r(null);let c="/api/organizations/".concat(null==e?void 0:e.uuid,"/prompt/improve/stream");try{var d,f,m;let e=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include",signal:u.signal});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let n=null==(d=e.body)?void 0:d.getReader(),r=new TextDecoder;if(!n)throw Error("No response body");let i="",s="",l=!1;for(;!l;){let e=await n.read();if(e.done){l=!0;break}let t=e.value,u=(i+=r.decode(t,{stream:!0})).split("\n");for(let e of(i=u.pop()||"",u))if(e.startsWith("data: ")){let t=e.slice(6);if("[DONE]"===t)continue;try{let e=JSON.parse(t);switch(e.type){case"content_block_delta":(null==(f=e.delta)?void 0:f.text)&&(s+=e.delta.text,a(e.delta.text));break;case"message_stop":o(e.improved_prompt||s);break;case"error":throw Error((null==(m=e.error)?void 0:m.message)||"Unknown error occurred")}}catch(e){}}else e.startsWith("event: ")&&e.slice(7)}}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;let e=t instanceof Error?t:Error(String(t));r(e),null==l||l(e),s("Failed to improve prompt: "+e.message)}finally{n(!1),i.current===u&&(i.current=null)}},[null==e?void 0:e.uuid,s]);return(0,c.useEffect)(()=>()=>{i.current&&i.current.abort()},[]),{streamImprovement:o,isStreaming:t,error:a}}(),e3=(0,c.useCallback)(async()=>{var e,t,n,a;if(!ec.trim())return;null==(e=Q.current)||e.setEditable(!1);let r="",i=!1;try{await e4({conversation_uuid:(null==X?void 0:X.id)||"new-conversation",prompt:ec},e=>{var t,n,a;i||(i=!0,ef(""),null==(a=Q.current)||a.setContent("")),r+=e,ef(r,{forceUpdateTiptap:!1}),null==(t=Q.current)||t.setContent(r),null==(n=Q.current)||n.scrollToEnd()},e=>{var t;ef(e),null==(t=Q.current)||t.setContent(e)},e=>{var t;ef(ec),null==(t=Q.current)||t.setContent(ec)})}catch(e){ef(ec),null==(t=Q.current)||t.setContent(ec)}finally{null==(n=Q.current)||n.setEditable(!0),null==(a=Q.current)||a.focus()}},[ec,null==X?void 0:X.id,e4,ef]),e9=(0,c.useCallback)(async e=>{if(eI(e),q){eM(!0);try{var t;await R({prompt:ec,attachments:en,files:er,syncSources:eg,model:e,project_uuid:eN,create_mode:null==X||null==(t=X.conversationSettings)?void 0:t.create_mode,...eO})}finally{eM(!1)}}},[eO,en,er,q,eN,ec,R,eg,null==X||null==(t=X.conversationSettings)?void 0:t.create_mode,eM]),te=(0,c.useCallback)(()=>{var e;return null==(e=Q.current)?void 0:e.focus()},[Q]),[tt,tn]=c.useState(!1),ta=(0,i.cV)(),tr=(0,k.R)(),[ti,ts,to,tl,tu,tc,td,tf]=(0,r.Si)({syncSourceCount:es.length,attachments:en,setAttachments:ea,numExistingConversationAttachments:null!=(L=null==X?void 0:X.attachmentsSoFar)?L:0,files:er,setFiles:ei,numExistingConversationFiles:null!=(F=null==X?void 0:X.files.length)?F:0,detectSameAttachment:()=>!1,selectedModel:eF,conversationUuid:null==X?void 0:X.id,blobFileUploadsEnabled:ta,wiggleEnabled:tr}),tm=en.length+er.length,tp=es.length,tg=ti||e_||ex,tv=tm>0||tp>0||tg,th=(0,c.useMemo)(()=>{var t;return{prompt:ec,tipTapEditorState:Z,attachments:en,files:e.willRedirectOnSubmit&&ey?null!=e$?e$:[]:er,syncSourceUuids:es,isAtMaxNumUploads:ev,isUploadingDriveSync:e_,isUploadingGithubSync:ex,model:eF,projectUuid:eN,beamChatUuid:eV,isNewBeamChat:eX,isChatSyncing:ep,personalizedStyle:eS,isProjectSyncing:eq,isNewConversation:void 0===X||0===X.messagesSoFar,isProjectLocked:void 0!==V||void 0!==X,isSending:ey,setPrompt:ef,setTipTapEditorState:ed,setAttachments:ea,setFiles:ei,setSyncSourceUuids:eo,setModel:e9,setProjectUuid:eQ,setBeamChatUuid:eH,setIsNewBeamChat:eZ,sendMessage:e6,sendTransparentMessage:e5,improvePrompt:e3,isImprovingPrompt:e8,stopSampling:H,conversation:X,focusInput:te,isFocused:eb,setIsFocused:eP,promptInputRef:Q,willRedirectOnSubmit:null!=(t=e.willRedirectOnSubmit)&&t,hasBlockingWarning:tt,setHasBlockingWarning:tn,setPersonalizedStyle:eT,setIsUploadingDriveSync:ej,setIsUploadingGithubSync:eA,includeProfilePreferences:ew,setIncludeProfilePreferences:ez,pendingConversationSettings:eO,setPendingConversationSettings:eR,isUploadingFile:ti,setIsUploadingFile:ts,validateMaxUploadLimit:to,onDrop:tl,onPasteFiles:tu,handleUpload:tc,uploadInputProps:tf,hasAttachments:tv,isModelSelectorOpen:eh,setIsModelSelectorOpen:ek,isPromptUnsafe:et,currentCompassTask:eC,setCurrentCompassTask:eE}},[en,X,er,te,V,tt,ew,ev,ep,eb,eq,ey,e_,ex,eF,eS,eN,eQ,eV,eX,ec,e.willRedirectOnSubmit,e6,e5,e3,e8,ea,ei,e9,eO,eR,eH,eZ,ef,eo,ed,H,es,Z,e$,ti,ts,to,tl,tu,tc,tf,tv,eh,ek,et,eC,eE,ez,eP,ej,eA,eT]);return(0,a.jsx)(P,{value:K,children:(0,a.jsx)(z.Provider,{value:th,children:G})})}},64683:(e,t,n)=>{n.d(t,{Si:()=>z,i1:()=>L,vV:()=>U,fU:()=>E});var a=n(42977),r=n(54568),i=n(16253),s=n(53478),o=n(67422),l=n(77187),u=n(85644),c=n(47492),d=n(98518),f=n(77186),m=n(1761),p=n(51121),g=n(90510),v=n(12072),h=n(29585),y=n(46612),b=n(71473),_=n(27062),x=n(69055),S=n(16622),w=n(87606),C=n(7620),k=n(62971),M=n(46760),P=n(81133),j=n(17936);let A=[{matcher:e=>e.includes("password protected")||e.includes("document_password_protected"),createMessage:()=>(0,r.jsx)(k.A,{defaultMessage:"The document you uploaded is password protected. Please remove the password and try again.",id:"DHwwKwuaCR"})},{matcher:e=>e.includes("not supported"),extractor:e=>[...new Set(e.map(e=>(0,i.QC)(e.file.name)))],createMessage:e=>(0,r.jsx)(k.A,{defaultMessage:"Files of the following {count, plural, one {format is} other {formats are}} not supported: {formats}",id:"9JcWWPAZoB",values:{count:e.length,formats:(0,r.jsx)(P.dT,{type:"conjunction",value:e})}})},{matcher:e=>e.includes("exceeds maximum size")||e.includes("File too large"),extractor:e=>e.map(e=>({file_type:e.file.type,file_size:e.file.size})),createMessage:()=>{let e=Math.floor(s.gZ/1048576);return(0,r.jsx)(k.A,{defaultMessage:"You may not upload files larger than {sizeLimit}mb.",id:"nW3gZD88Va",values:{sizeLimit:e}})},trackAnalytics:(e,t)=>{e.track({event_key:"file_upload_too_large",large_files:t})}}];function T(){let e=(0,a._)(["\n  relative\n  grid\n  place-content-center\n  aspect-square\n  rounded-xl\n  cursor-pointer\n  transition\n  [fieldset:not(:disabled)_&]:hover:bg-bg-400\n  [fieldset:disabled_&]:opacity-50\n  [fieldset:disabled_&]:pointer-events-none\n  focus-within:ring\n  inline-flex\n  items-center\n  justify-center\n  relative\n  shrink-0\n  ring-offset-2\n  ring-offset-bg-300\n  ring-accent-main-100\n  focus-visible:outline-none\n  focus-visible:ring-1\n  disabled:pointer-events-none\n  disabled:opacity-50\n  disabled:shadow-none\n  disabled:drop-shadow-none\n  bg-[radial-gradient(ellipse,_var(--tw-gradient-stops))]\n  from-bg-500/10\n  from-50%\n  to-bg-500/30\n  border-0.5\n  border-border-400\n  font-medium\n  font-ui\n  text-text-100/90\n  transition-colors\n  active:bg-bg-500/50\n  hover:text-text-000\n  hover:bg-bg-500/60\n"]);return T=function(){return e},e}function z(e){let{syncSourceCount:t,files:n,setFiles:a,numExistingConversationFiles:o,attachments:c,setAttachments:d,numExistingConversationAttachments:f,detectSameAttachment:m,selectedModel:g,blobFileUploadsEnabled:h,conversationUuid:y,wiggleEnabled:b}=e,{addError:_}=(0,p.Y)(),w=(0,l.Z3)(null);return function(e){let{syncSourceCount:t,onUploadComplete:n,existingAttachments:a,existingFiles:o,numExistingConversationAttachments:l,numExistingConversationFiles:c,selectedModel:d,blobFileUploadsEnabled:f,conversationUuid:m,wiggleEnabled:p}=e,g=(0,M.A)(),{modelConfig:h}=(0,u.fC)(d),y=h.image_in,[b,_,w,P]=function(e){let{syncSourceCount:t,onUploadComplete:n,existingAttachments:a,existingFiles:i,numExistingConversationFiles:o,selectedModel:l,blobFileUploadsEnabled:c,conversationUuid:d,wiggleEnabled:f}=e,{modelConfig:m}=(0,u.fC)(l),p=m.image_in,g=L()&&m.pdf_in,{isUploading:v,setIsUploading:h,handleError:y,handleUpload:b}=U({imagesEnabled:p,blobFileUploadsEnabled:c,onUploadComplete:n,rasterizePdfUploadsEnabled:g,conversationUuid:d,wiggleEnabled:f}),_=(0,C.useCallback)(e=>{let{newUploads:n=[],numNewPotentialAttachments:l=0,showError:u=!0}=e;if(l+n.length+(a.length+i.length+t)>s.XA.maxTotalUploadsPerMessage)return u&&y((0,r.jsx)(k.A,{defaultMessage:"You can add at most {count, plural, one {# attachment} other {# attachments}} to a message. Please select fewer attachments.",id:"qxV00r12ob",values:{count:s.XA.maxTotalUploadsPerMessage}})),!1;let d=o||0,{messageFileCount:f}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0,a=0,r=0;for(let i of e){let{willBecomeMessageFile:e,category:o}=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(null==(t=e.name.split(".").pop())?void 0:t.toLowerCase())||"";return s.h8.includes(a)?{category:"image",willBecomeMessageFile:!!n.imagesEnabled}:s.Ap.includes(a)?{category:"pdf",willBecomeMessageFile:!!n.rasterizePdfUploadsEnabled,requiresFeatureGate:"janus_claude-ai"}:s.PC.includes(a)||s.uC.includes(a)?{category:"out-of-context",willBecomeMessageFile:!!n.blobFileUploadsEnabled,requiresFeatureGate:"ooc_attachments"}:s.BA.includes(a)?{category:"text",willBecomeMessageFile:!1}:s.pH.includes(a)?{category:"document",willBecomeMessageFile:!1}:{category:"unsupported",willBecomeMessageFile:!1}}(i,t);"unsupported"===o?r++:e?n++:a++}return{messageFileCount:n,messageAttachmentCount:a,unsupportedCount:r}}(n,{blobFileUploadsEnabled:c,imagesEnabled:p,rasterizePdfUploadsEnabled:g});if(d+f>s.XA.maxFilesPerConversation){var m;return u&&y((m=s.XA.maxFilesPerConversation,(0,r.jsx)(k.A,{defaultMessage:"You can add at most {count, plural, one {# file} other {# files}} to a chat. {suggestion}",id:"QyrCxYs5Jy",values:{count:m,suggestion:d<m?(0,r.jsx)(k.A,{defaultMessage:"Please select fewer files.",id:"a6KVizNPLe"}):(0,r.jsx)(k.A,{defaultMessage:"Please consider starting a new chat.",id:"oN0R8lZNm6"})}}))),!1}return!0},[a,i,t,y,c,o,p,g]);return[v,h,_,(0,C.useCallback)(async e=>{_({newUploads:e})&&await b(e)},[b,_])]}({syncSourceCount:t,onUploadComplete:n,existingFiles:o,existingAttachments:a,numExistingConversationFiles:c,numExistingConversationAttachments:l,selectedModel:d,blobFileUploadsEnabled:f,conversationUuid:m,wiggleEnabled:p}),j=function(e){let{handleUpload:t}=e,n=(0,C.useRef)({ready:0,total:0}),a=(0,C.useCallback)(()=>{n.current={ready:0,total:0}},[]),r=(0,C.useCallback)(e=>{n.current.ready+=1,n.current.total===n.current.ready&&t(e)},[t]),i=(0,C.useCallback)((e,t)=>{let a=e.length;for(let s=0;s<a;s++){let a=e[s];a.isFile?(n.current.total+=1,a.file(e=>{t.push(e),r(t)})):a.isDirectory&&a.createReader().readEntries(e=>{i(e,t)})}},[r]);return(0,C.useCallback)(e=>{var t;e.preventDefault(),a();let n=null==(t=e.dataTransfer)?void 0:t.items;if(!n)return;let r=[];for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e].webkitGetAsEntry();t&&r.push(t)}i(r,[])},[i,a])}({handleUpload:P}),A=(0,C.useCallback)(async e=>{await P(Array.from(e))},[P]),T=(0,C.useCallback)(async e=>{let t=e.target.files;t&&await P(Array.from(t)),e.target.value=""},[P]),z=Math.floor(s.XA.maxFileSize/1048576),E=y?(0,r.jsx)(k.A,{defaultMessage:"Upload docs or images to Claude\\n(Max {maxUploads}, {maxSize}mb each)",id:"TGYeob9u0b",values:{maxUploads:s.XA.maxTotalUploadsPerMessage,maxSize:z}}):(0,r.jsx)(k.A,{defaultMessage:"Add content ({maxUploads} max, {maxSize}mb each)\\nAccepts pdf, txt, csv, etc.",id:"rW/kw78ou7",values:{maxUploads:s.XA.maxTotalUploadsPerMessage,maxSize:z}}),F=(0,C.useCallback)(e=>{T(e)},[T]),O=(0,C.useMemo)(()=>({type:"file",accept:p?"":(0,i.cm)({imagesEnabled:y,outOfContextFilesEnabled:f}).join(","),onChange:F,multiple:!0,"aria-label":g.formatMessage({defaultMessage:"Upload files",id:"2jjdVzJX0c"})}),[y,f,p,F,g]);return[b,_,w,j,A,P,(0,r.jsx)(v.m,{className:"text-center",tooltipContent:E,children:(0,r.jsxs)(I,{children:[(0,r.jsx)("input",{"data-testid":"file-upload",className:"absolute inset-0 -z-10 overflow-hidden rounded-xl opacity-0",...O}),b?(0,r.jsx)(x.N,{className:"animate-spin",size:18}):(0,r.jsx)(S.x,{size:18,weight:"light"})]})},"upload-tooltip"),O]}({syncSourceCount:t,onUploadComplete:(0,C.useCallback)(async(e,t)=>{if(m&&e.find(e=>m(e.extracted_content)))return void _((0,r.jsx)(k.A,{defaultMessage:"The same attachment was already added earlier. Claude sees the full conversation when replying, so there’s no need to re-upload.",id:"Uo3qvhGn7z"}));d(t=>[...t,...e]),a(e=>[...e,...t]),await Promise.resolve()},[m,_,d,a]),existingAttachments:c,existingFiles:n,numExistingConversationAttachments:f,numExistingConversationFiles:o,selectedModel:null!=g?g:w,blobFileUploadsEnabled:h,conversationUuid:y,wiggleEnabled:b})}let E=()=>{let e=(0,f.mn)(),t=(0,w.useQueryClient)();return async(n,a,r)=>{let i=new FormData;i.append("file",n);let s=r?"/api/organizations/".concat(a,"/projects/").concat(r,"/upload"):"/api/".concat(a,"/upload"),o=await e(s,{method:"POST",body:i}),l=await o.json();if(o.ok)return r&&t.invalidateQueries({queryKey:[b.qz,{orgUuid:a,projectUuid:r}]}),l;throw(0,h.a5)(o.status,l,"File upload failed",o.headers)}},U=e=>{var t;let{imagesEnabled:n,blobFileUploadsEnabled:a,rasterizePdfUploadsEnabled:i,onUploadComplete:l,onError:u,projectUuid:f,conversationUuid:g,wiggleEnabled:v}=e,{activeOrganization:b}=(0,m.YL)(),_=null!=(t=null==b?void 0:b.uuid)?t:"",[x]=(0,c.d)(),S=g||x,[w,M]=(0,C.useState)(!1),{addError:P}=(0,p.Y)(),T=(()=>{let{addError:e}=(0,p.Y)();return(0,C.useCallback)((t,n)=>{if(t instanceof h.LG){if("rate_limit_error"===t.type)return void e((0,r.jsxs)("p",{children:[(0,r.jsx)(k.A,{defaultMessage:"You’ve reached your limit for {resourceType} uploads. Please try again later.",id:"M88GeEDB7r",values:{resourceType:n}}),(0,r.jsx)(j.W,{})]}));if("document_password_protected"===t.errorCode)return void e((0,r.jsx)("p",{children:(0,r.jsx)(k.A,{defaultMessage:"The document you uploaded is password protected. Please remove the password and try again.",id:"DHwwKwuaCR"})}))}if(t instanceof h.LG&&"Image is too large"===t.message)return void e((0,r.jsx)("p",{children:(0,r.jsx)(k.A,{defaultMessage:"Image is too large. <link>Learn more</link>",id:"SFbt+MAvby",values:{link:e=>(0,r.jsx)("a",{href:"https://support.anthropic.com/en/articles/9002500-what-kinds-of-images-can-i-upload-to-claude-ai",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-accent-main-100",children:e})}})}));e((0,r.jsx)("p",{children:(0,r.jsx)(k.A,{defaultMessage:"Your {resourceType} upload failed. Please try again.",id:"ymWsV10Pz1",values:{resourceType:n}})}))},[e])})(),z=(0,C.useCallback)(e=>{M(!1),P(e),u&&u()},[P,u,M]),E=(0,d.st)(),U=(0,C.useCallback)(async(e,t)=>{M(!0);try{if(!_)throw Error("Organization not loaded. Please try again.");let u=(0,o.e)(),c=(0,o.O)(e),d=function(e){let{orgUuid:t,projectUuid:n,conversationUuid:a,imagesEnabled:r,rasterizePdfUploadsEnabled:i,blobFileUploadsEnabled:o,wiggleEnabled:l}=e;return{orgUuid:t,projectUuid:n,conversationUuid:a,modelConfig:{image_in:r,pdf_in:i},featureGates:{janus_claude_ai:i,ooc_attachments:o,use_canvas_resize:!0,wiggleEnabled:l},limits:s.XA}}({orgUuid:_,projectUuid:f,conversationUuid:S,imagesEnabled:n,rasterizePdfUploadsEnabled:i,blobFileUploadsEnabled:a,wiggleEnabled:v}),m=await u.processFiles(c,d),{attachments:p,files:g,errors:h}=function(e){let t=[],n=[],a=[];for(let a of e.successful){let e=a.data;"attachment"===a.type?"extracted_content"in e&&t.push(e):"file_kind"in e&&n.push(e)}for(let t of e.failed)a.push({file:t.file,error:t.error});return{attachments:t,files:n,errors:a}}(m);if(function(e,t,n){if(0===e.length)return!1;for(let a of A){let r=e.filter(e=>a.matcher(e.error));if(r.length>0){let e=a.extractor?a.extractor(r):r;return a.trackAnalytics&&a.trackAnalytics(n,e),t(a.createMessage(e)),!0}}return e.forEach(e=>t(e.error)),!0}(h,z,E))return;let b=function(e,t,n){if(void 0===t||0===e.length)return e;let a=0,i=[];for(let s of e){if((a+=new Blob([s.extracted_content]).size/y.t2)>t)return n((0,r.jsx)(k.A,{defaultMessage:"Failed to upload file {filename}. Project knowledge exceeds maximum. Remove files to continue.",id:"MbvF6K3PJd",values:{filename:s.file_name}})),[];i.push(s)}return i}(p,t,z);if(0===b.length&&p.length>0)return;(b.length>0||g.length>0)&&await l(b,g)}catch(t){if(function(e,t){return e instanceof Error?(e.isRateLimit?t((0,r.jsx)(k.A,{defaultMessage:"Too many file upload attempts. Please wait and try again later.",id:"h/6cMHSn1V"})):413===e.statusCode||"file_too_large"===e.errorType?t((0,r.jsx)(k.A,{defaultMessage:"Uploaded file is too large. Try uploading a smaller part of the document, or copy/pasting an excerpt from the file.",id:"/mCoauj3Ws"})):"extraction_failed"===e.errorType?t((0,r.jsx)(k.A,{defaultMessage:"Text extraction failed for one of the uploaded files. Please try again.",id:"ngYPeW4aWf"})):t((0,r.jsx)(k.A,{defaultMessage:"One or more file uploads have failed. Please try again.",id:"FIwcYDeyIC"})),!0):(t((0,r.jsx)(k.A,{defaultMessage:"One or more file uploads have failed. Please try again.",id:"FIwcYDeyIC"})),!0)}(t,z))return;let e="file";t instanceof Error&&t.message.includes("image")&&(e="image"),T(t,e)}finally{M(!1)}},[a,l,n,S,z,T,_,E,i,f,v]);return{isUploading:w,setIsUploading:M,handleError:z,handleUpload:U}},I=g.J.label(T()),L=()=>{let{value:e}=(0,_.fS)("janus_claude-ai");return e}},71165:(e,t,n)=>{n.d(t,{S:()=>f,v:()=>d});var a=n(54568),r=n(41417),i=n(76761),s=n(60265),o=n(62942),l=n(25173),u=n(62971),c=n(50707);function d(e){let{isOpen:t,onClose:n,limitType:d="projects",customTitle:f,customDescription:m}=e,p=(0,o.useRouter)(),g=["opus"===d?{defaultMessage:"More Opus usage*",id:"JxRTAGj5OB"}:"message_limit"===d?{defaultMessage:"Access to tools like research and web search",id:"message_limit_benefit_tools"}:{defaultMessage:"Access to unlimited Projects to organize chats and documents",id:"uK9wA9v6Z3"},"opus"===d&&{defaultMessage:"Access to unlimited Projects to organize chats and documents",id:"uK9wA9v6Z3"},"projects"===d&&{defaultMessage:"More usage*",id:"Rve6Z5dM8k"},"message_limit"===d&&{defaultMessage:"Claude Code directly in your terminal",id:"message_limit_benefit_code"},"message_limit"===d&&{defaultMessage:"Integration to Google Workspace: email, calendar, and docs",id:"message_limit_benefit_workspace"},"message_limit"===d&&{defaultMessage:"Full access to the newest Claude models including Opus",id:"message_limit_benefit_models"},"message_limit"===d&&{defaultMessage:"Extended thinking for complex work",id:"message_limit_benefit_thinking"},"message_limit"!==d&&{defaultMessage:"Ability to search the web",id:"dl29r7OlXE"},"message_limit"!==d&&{defaultMessage:"Extended thinking for complex work",id:"mENE7vJhVQ"},"message_limit"!==d&&{defaultMessage:"Connect Google Workspace: email, calendar, and docs",id:"WwXweMd3IE"},"message_limit"!==d&&{defaultMessage:"Ability to use more Claude models",id:"Qpr1Da1f7N"}].filter(Boolean);return(0,a.jsx)(l.bL,{open:t,onOpenChange:n,children:(0,a.jsx)(l.ZL,{children:(0,a.jsx)(l.hJ,{className:"fixed inset-0 bg-always-black/50 backdrop-brightness-75 z-modal flex items-center justify-center data-[state=open]:animate-[fade_250ms_ease-in_forwards] data-[state=closed]:animate-[fade_125ms_ease-out_reverse_forwards]",children:(0,a.jsxs)(l.UC,{className:"z-modal w-full max-w-sm bg-bg-000 rounded-2xl shadow-xl overflow-hidden focus:outline-none data-[state=open]:animate-[zoom_250ms_ease-in_forwards] data-[state=closed]:animate-[zoom_125ms_ease-out_reverse_forwards]",onEscapeKeyDown:e=>{e.preventDefault(),n()},onInteractOutside:e=>{e.preventDefault(),n()},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-5 pt-4",children:[(0,a.jsx)(c.M,{}),(0,a.jsx)(l.bm,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"ghost",size:"icon_sm",className:"text-text-400 hover:text-text-200",children:(0,a.jsx)(i.X,{size:20,weight:"regular"})})})]}),(0,a.jsxs)("div",{className:"px-5 pb-4 pt-2",children:[(0,a.jsx)("h2",{className:"text-[24px] leading-tight font-medium mb-2 text-text-000",children:f||("opus"===d?(0,a.jsx)(u.A,{defaultMessage:"More Opus with Pro and Max plans",id:"//ixi/rP/O"}):"message_limit"===d?(0,a.jsx)(u.A,{defaultMessage:"Keep chatting with Claude",id:"u3sKHTmxou"}):(0,a.jsx)(u.A,{defaultMessage:"Unlimited projects with Pro and Max plans",id:"RKBJDiWP1p"}))}),(0,a.jsx)("p",{className:"".concat("message_limit"===d?"text-sm":"text-base"," text-text-300 mb-3"),children:m||("opus"===d?(0,a.jsx)(u.A,{defaultMessage:"Free plans only get 3 Opus messages per week. Try again after {date}, or upgrade now to get:",id:"IIJcLbtXZK",values:{date:new Date(Date.now()+6048e5).toLocaleDateString("en-US",{month:"long",day:"numeric"})}}):"message_limit"===d?(0,a.jsx)(u.A,{defaultMessage:"You just hit your free message limit. Upgrade to Pro (or Max) to send more messages. You also get:",id:"vXAAoQRvRg"}):(0,a.jsx)(u.A,{defaultMessage:"Free plans only get access to one Project. Upgrade now to get:",id:"NOiyw9Bber"}))}),(0,a.jsx)("div",{className:"space-y-1.5 mb-6",children:g.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,a.jsx)(s.J,{className:"text-text-400 mt-0.5 flex-shrink-0",size:18,weight:"regular"}),(0,a.jsx)("span",{className:"text-sm text-text-200",children:(0,a.jsx)(u.A,{...e})})]},"benefit-".concat(t)))}),("opus"===d||"projects"===d)&&(0,a.jsx)("p",{className:"text-xs text-text-400 mb-4",children:(0,a.jsx)("a",{href:"https://support.anthropic.com/en/articles/11049762-choosing-a-claude-ai-plan",target:"_blank",rel:"noopener noreferrer",className:"text-text-400 underline hover:text-text-300",children:(0,a.jsx)(u.A,{defaultMessage:"*Usage limits apply",id:"HFRZOFWXCf"})})}),(0,a.jsx)(r.$,{variant:"primary",size:"lg",className:"w-full text-base font-medium",onClick:()=>{n(),p.push("/upgrade")},children:(0,a.jsx)(u.A,{defaultMessage:"See plans",id:"vbFKkTYpN+"})})]})]})})})})}let f=d},72431:(e,t,n)=>{n.d(t,{S:()=>d,r:()=>f});var a=n(54568),r=n(89256),i=n.n(r),s=n(62942),o=n(7620),l=n(72697);let u="incognito",c=o.createContext({incognitoModeEnabled:!1,setIncognitoModeEnabled:i(),temporaryConversationUUID:null,setTemporaryConversationUUID:i()}),d=()=>o.useContext(c),f=e=>{let{children:t}=e,n=(0,s.useRouter)(),r=(0,s.useSearchParams)(),i=(0,l.I_)(),d=r.has(u),[f,m]=(0,o.useState)(d),p=(0,o.useRef)(f),[g,v]=(0,o.useState)(null);(0,o.useEffect)(()=>{p.current=f},[f]);let h=(0,o.useCallback)(e=>{if(m(e),e)n.push("?".concat(u));else{v(null);let e=new URLSearchParams(r.toString());e.delete(u);let t=e.toString();n.push("".concat(window.location.pathname).concat(t?"?".concat(t):""),void 0)}},[n,r]);(0,o.useEffect)(()=>{p.current&&!d&&h(!1)},[h,d]);let y=(0,o.useMemo)(()=>({incognitoModeEnabled:!!i&&f,setIncognitoModeEnabled:h,temporaryConversationUUID:i?g:null,setTemporaryConversationUUID:v}),[f,h,g,v,i]);return(0,a.jsx)(c.Provider,{value:y,children:t})}},72697:(e,t,n)=>{n.d(t,{Uq:()=>h,I_:()=>A,BV:()=>z,Rb:()=>T,tW:()=>b,L1:()=>x,SK:()=>k,Mf:()=>S,PB:()=>C,Ah:()=>P,UG:()=>w,lH:()=>M,xt:()=>j,mM:()=>_});var a=n(68096),r=n(77186),i=n(1761),s=n(51121),o=n(22529),l=n(71473),u=n(27062),c=n(87606),d=n(7620),f=n(46760),m=n(75006),p=n(98251);let g=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ");var v=n(92075);let h="https://support.anthropic.com/articles/11817273-how-does-claude-s-memory-work",y=m.z.object({memory:m.z.string(),controls:m.z.array(m.z.string()).nullable(),updated_at:m.z.string().datetime({offset:!0}).nullable()}),b=(e,t)=>{var n,a;let{account:s,activeOrganization:o}=(0,i.YL)(),u=null==s?void 0:s.uuid,c=null==o?void 0:o.uuid,f=S(),m=e?"/api/organizations/".concat(c,"/memory?project_uuid=").concat(e):"/api/organizations/".concat(c,"/memory"),p=(0,r.Sk)(m,{queryKey:[l.IX,{accountUUID:u,orgUUID:c,projectUUID:e}],enabled:!!o&&(null==(a=null==t?void 0:t.enabled)||a)&&f},e=>y.parse(e)),v=(0,d.useMemo)(()=>{var e,t;return(e=>{let t;if(!e.length)return"";let n=/<([^>]+)>([\s\S]*?)<\/\1>/g,a=e,r=!0;for(;null!==(t=n.exec(e));){let[e,n,i]=t,s=g(n),o=r?"":"\n\n \n\n",l="".concat(o,"#### ").concat(s,"\n\n").concat(i.trim());a=a.replace(e,l),r=!1}return a.trim().replace(/\n{3,}/g,"\n\n")})(null!=(t=null==(e=p.data)?void 0:e.memory)?t:"")},[null==(n=p.data)?void 0:n.memory]);return{...p,data:p.data?{...p.data,memory:v}:p.data}},_=function(){let{projectUUID:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:n}=(0,i.YL)(),a=null==t?void 0:t.uuid,u=null==n?void 0:n.uuid,d=S(),{addError:m,addSuccess:p}=(0,s.Y)(),g=(0,f.A)(),v=(0,c.useQueryClient)(),{mutate:h,isPending:y}=(0,r.Qv)("/api/organizations/".concat(u,"/memory/controls"),"PUT",(e,t)=>{var n;return{memory:null!=(n=null==t?void 0:t.memory)?n:"",controls:e.controls,updated_at:null==t?void 0:t.updated_at}},{queryKey:[l.IX,{accountUUID:a,orgUUID:u,projectUUID:e}],enabled:!!n&&d,onSuccess:()=>{p((0,o.O)({id:"serif_net_popcorn",intl:g})),v.invalidateQueries({queryKey:[l.IX,{accountUUID:a,orgUUID:u,projectUUID:e}]})},onError:()=>{m((0,o.O)({id:"frigid_umbrella_sunflower",intl:g}))}});return{updateMemoryControls:h,updateMemoryControlsIsPending:y}},x=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid,n=S(),a=t?"/api/organizations/".concat(t,"/memory/themes"):null;return(0,r.Sk)(a,{staleTime:3e5,enabled:!!t&&!!a&&n})},S=()=>{let{value:e}=(0,u.fS)("claudeai_saffron_enabled");return e},w=()=>{let e=S(),t=k();return e&&!!t},C=()=>{var e;let t=(0,i.mV)(),{data:n}=(0,v.rX)(),a=!!n&&!(null==(e=n.disabled_features)?void 0:e.includes("saffron"));return!t||a},k=()=>{var e;let t=C(),{account:n}=(0,i.YL)(),{value:a}=(0,u.fS)("claudeai_saffron_default_enabled");return!!t&&(null!=(e=null==n?void 0:n.settings.enabled_saffron)?e:a||void 0)},M=()=>{let{account:e}=(0,i.YL)(),{mutate:t}=(0,a.Jy)(),{resetMemory:n}=(()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid,n=S(),{addError:a}=(0,s.Y)(),u=(0,f.A)(),d=(0,c.useQueryClient)(),{mutate:m,isPending:p}=(0,r.L2)("/api/organizations/".concat(t,"/memory/reset"),"POST",{enabled:!!e&&n,onSuccess:()=>{d.invalidateQueries({queryKey:[l.IX]})},onError:()=>{a((0,o.O)({id:"frog_book_coffee",intl:u}))}});return{resetMemory:m,isResettingMemory:p}})();return(a,r)=>{t({...null==e?void 0:e.settings,enabled_saffron:a}),(null==r?void 0:r.shouldResetMemory)&&n()}},P=()=>{let{value:e}=(0,u.fS)("claudeai_saffron_search_enabled");return e},j=()=>{let{account:e}=(0,i.YL)(),t=(()=>{var e;let{account:t}=(0,i.YL)(),n=(()=>{let{value:e}=(0,u.fS)("claudeai_saffron_search_default_enabled");return e})();return null!=(e=null==t?void 0:t.settings.enabled_saffron_search)?e:n})(),n=P(),{mutate:r}=(0,a.Jy)(),{mutate:s}=(0,p.nI)(),o=(0,d.useRef)(null==e?void 0:e.settings);return(0,d.useEffect)(()=>{o.current=null==e?void 0:e.settings},[null==e?void 0:e.settings]),{toggleSaffronSearch:(0,d.useCallback)(e=>{r({...o.current,enabled_saffron_search:e}),n&&e&&s({})},[r,s,n]),saffronSearchEnabled:t}},A=()=>S(),T=()=>(0,u.T9)("claudeai_saffron_frontend","max_num_controls",10,u.T2),z=()=>(0,u.T9)("claudeai_saffron_frontend","max_control_chars",100,u.T2)},74530:(e,t,n)=>{function a(e){return"text"===e.type&&e.text?{...e,text:e.text.replace("​","")}:e.content?{...e,content:e.content.map(a)}:e}n.d(t,{DV:()=>a,h0:()=>r});let r=e=>{let t="",n=0,a=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("doc"===e.type&&e.content)for(let t of e.content)a(t);else if("paragraph"===e.type){if(e.content)for(let t of e.content)a(t);t+="\n"}else if("text"===e.type){let n=e.text;if(e.marks)for(let t of e.marks)"bold"===t.type?n="**".concat(n,"**"):"italic"===t.type?n="*".concat(n,"*"):"underline"===t.type?n="__".concat(n,"__"):"strike"===t.type?n="~~".concat(n,"~~"):"code"===t.type&&(n="`".concat(n,"`"));t+=n}else if("codeBlock"===e.type){let n=e.attrs&&"string"==typeof e.attrs.language?e.attrs.language:"";if(t+="\n```".concat(n,"\n"),e.content)for(let t of e.content)a(t);t+="\n```\n\n"}else if("bulletList"===e.type&&e.content)for(let t of e.content)a(t);else if("orderedList"===e.type&&e.content)for(let t=0;t<e.content.length;t++)a(e.content[t],t+1,!0);else if("listItem"===e.type&&e.content){let s="   ".repeat(n);for(let o of(i?t+="".concat(s).concat(r,". "):t+="".concat(s,"* "),e.content))n+=1,a(o),n-=1}};return a(e),t.replace("​","").trim()}},75973:(e,t,n)=>{n.d(t,{d:()=>i}),n(54568),n(68096),n(1761),n(46127);var a=n(7620);let r=(0,a.createContext)({isInBeam:!1,beamUuid:void 0,beamConversationSettings:void 0,setBeamConversationSettings:void 0}),i=()=>(0,a.useContext)(r)},83092:(e,t,n)=>{n.d(t,{PerformanceMetricsProvider:()=>_,B:()=>x});var a=n(54568);class r extends Error{}class i{add(e){this.buffer[this.head]=e,this.head=(this.head+1)%this.maxSize,this.currentSize<this.maxSize&&this.currentSize++}addAll(e){for(let t of e)this.add(t)}flush(){this.head=0,this.currentSize=0,this.buffer=Array(this.maxSize)}get size(){return this.currentSize}get isEmpty(){return 0===this.currentSize}get isFull(){return this.currentSize===this.maxSize}*values(){if(0===this.currentSize)return;let e=this.isFull?this.head:0;for(let t=0;t<this.currentSize;t++){let n=(e+t)%this.maxSize;yield this.buffer[n]}}toArray(){return Array.from(this.values())}getLast(){if(0===this.currentSize)return;let e=(this.head-1+this.maxSize)%this.maxSize;return this.buffer[e]}getFirst(){if(0===this.currentSize)return;let e=this.isFull?this.head:0;return this.buffer[e]}constructor(e){if(this.maxSize=e,this.head=0,this.currentSize=0,e<1)throw new r("RingBuffer maxSize must be 1 or more");this.buffer=Array(e)}}var s=n(27630),o=n(27062);let l={};var u=n(34762);let c={},d="performance";function f(e,t){let{metricType:n=e.replace(/^.+?\./,""),duration:a=0,attributes:r={},performanceAttributes:i={},tracer:f=(!c.tracer&&(c.tracer=u.u.getTracer("claude-ai-performance","1.0.0")),c.tracer)}=t,m=f.startSpan(e),p="".concat(d,".").concat(n),g={...r,["".concat(d,".metric_type")]:n,...(0,s.r)(p,i),...function(){if(l.attributes)return l.attributes;let e=(0,o.Je)(),t=(0,s.r)("statsig",{smoother_optimization:!!(null==e?void 0:e.getExperiment("smoother_optimization").get("enabled",!1))});return e&&(l.attributes=t),t}()};a>0&&(g["".concat(p,".duration_ms")]=a,g.duration_ms=a),m.setAttributes(g),m.end()}class m{get mean(){return this.count>0?this._mean:0}get variance(){return this.count>1?this._m2/(this.count-1):0}get stdDev(){return Math.sqrt(this.variance)}calculate(){let e=this._tail-this._mean;this._mean+=e/this.count;let t=this._tail-this._mean;this._m2+=e*t}getSummary(){return{count:this.count,sum:this.sum,min:this.min,max:this.max,mean:this.mean,variance:this.variance,stdDev:this.stdDev}}reset(){this.count=0,this.sum=0,this.min=1/0,this.max=-1/0,this._mean=0,this._m2=0}add(e){this.count+=1,this.sum+=e,this.min=Math.min(this.min,e),this.max=Math.max(this.max,e),this._tail=e,this.calculate()}constructor(){this.count=0,this.sum=0,this.min=1/0,this.max=-1/0,this._tail=0,this._mean=0,this._m2=0,this.reset()}}class p{init(){if("PerformanceLongTaskTiming"in window)try{this.events.longTask.observer=this.initLongTaskObserver()}catch(e){console.error("PerfMon LongTaskObserver failed to init")}if("PerformanceEventTiming"in window)try{this.events.inputDelay.observer=this.initInputDelayObserver()}catch(e){console.error("PerfMon EventTimingObserver failed to init")}if("PerformanceLongAnimationFrameTiming"in window)try{this.events.longAnimationFrame.observer=this.initLongAnimationFrameObserver()}catch(e){console.error("PerfMon EventTimingObserver failed to init")}this.startReportMetricsInterval(),this.registerVisibilityHandlers()}initLongTaskObserver(){let e=new PerformanceObserver(e=>{for(let n of e.getEntries()){let{attribution:e}=n;if(this.events.longTask.stats.add(n.duration),n.duration>=250){var t;this.events.longTask.buffer.add({start_time:n.startTime,duration_ms:n.duration,attribution_count:null!=(t=null==e?void 0:e.length)?t:0})}}});return e.observe({entryTypes:["longtask"]}),e}initInputDelayObserver(){let e=new PerformanceObserver(e=>{for(let n of e.getEntries()){let e=n.processingStart?n.processingStart-n.startTime:0;if(e>100){this.events.inputDelay.stats.add(n.duration);let a=Number(n.processingEnd)-Number(n.processingStart);if(e>250||a>250){var t;this.events.inputDelay.buffer.add({start_time:n.startTime,duration_ms:e,processing_duration_ms:a,inp_duration_ms:n.duration,event_name:n.name,event_target_id:(null==(t=n.target)?void 0:t.id)||"unknown_target",is_fid:"first-input"===n.entryType})}}}});return e.observe({entryTypes:["event","first-input"]}),e}initLongAnimationFrameObserver(){let e=new PerformanceObserver(e=>{for(let t of e.getEntries()){let{blockingDuration:e}=t;if(this.events.longAnimationFrame.stats.add(t.duration),t.duration>=250){let n={start_time:t.startTime,duration_ms:t.duration,blocking_duration_ms:e||0};this.events.longAnimationFrame.buffer.add(n)}}});return e.observe({entryTypes:["long-animation-frame"]}),e}startReportMetricsInterval(){let e=()=>{this.reportMetricsTimeoutId=window.setTimeout(()=>{this.reportMetrics(),this.isActive&&e()},12e4)};e()}registerVisibilityHandlers(){document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&this.reportMetrics()},{passive:!0}),window.addEventListener("pagehide",()=>this.reportMetrics(),{passive:!0})}reportMetrics(){this.isActive&&Object.values(this.events).forEach(e=>{let{name:t,stats:n,buffer:a}=e;0!==n.mean&&(f("events.".concat(t,".summary"),{metricType:"".concat(t,"_summary"),performanceAttributes:{...n.getSummary()}}),a.toArray().forEach(e=>{let{duration_ms:n,...a}=e;f("events.".concat(t),{metricType:"".concat(t,"_event"),duration:n,performanceAttributes:{...a}})}),n.reset(),a.flush())})}destroy(){this.isActive=!1,Object.values(this.events).forEach(e=>{var t;null==(t=e.observer)||t.disconnect(),e.observer=void 0}),clearTimeout(this.reportMetricsTimeoutId),this.reportMetricsTimeoutId=void 0,this.reportMetrics()}forceReport(){this.reportMetrics()}constructor(){this.isActive=!0,this.events={longTask:{name:"long_task",stats:new m,buffer:new i(100)},inputDelay:{name:"input_delay",stats:new m,buffer:new i(100)},longAnimationFrame:{name:"loaf",stats:new m,buffer:new i(100)}},this.init()}}class g{initPerfMon(){this.perfMon||(this.perfMon=new p)}trackNewChatInputReady(e,t){f("page.new_chat_input_ready",{duration:e,attributes:{is_first_load:t}})}trackTTFT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};t.model&&(n["chat.model"]=t.model),f("chat.time_to_first_token",{metricType:"ttft",duration:e,attributes:n})}trackProjectConversationsReady(e){f("page.project_conversations_ready",{duration:e})}trackMembersListReady(e){f("page.members_list_ready",{duration:e})}constructor(){this.perfMon=null}}let v=new g;var h=n(62942),y=n(7620);let b=(0,y.createContext)(null);function _(e){let{children:t}=e,n=(0,h.usePathname)(),r=(0,y.useRef)(!0),i=(0,y.useRef)(null),s=(0,y.useRef)(!1),o=(0,y.useRef)(null),l=(0,y.useRef)(!1),u=(0,y.useRef)(null),c=(0,y.useRef)(!1),d=(0,y.useRef)(null),f=(0,y.useRef)(!1);(0,y.useEffect)(()=>{v.initPerfMon()},[]),(0,y.useEffect)(()=>{"/new"===n?(i.current=r.current?0:performance.now(),s.current=!1):(null==n?void 0:n.startsWith("/project/"))?(u.current=performance.now(),c.current=!1):"/settings/members"===n&&(d.current=performance.now(),f.current=!1),r.current=!1},[n]);let m=(0,y.useCallback)(()=>{if(s.current||null===i.current)return;s.current=!0;let e=performance.now()-i.current;v.trackNewChatInputReady(e,0===i.current),i.current=null},[]),p=(0,y.useCallback)(()=>{o.current=performance.now(),l.current=!1},[]),g=(0,y.useCallback)(e=>{if(null===o.current||l.current)return;l.current=!0;let t=performance.now()-o.current;v.trackTTFT(t,e),o.current=null},[]),_=(0,y.useCallback)(()=>{if(c.current||null===u.current)return;c.current=!0;let e=performance.now()-u.current;v.trackProjectConversationsReady(e),u.current=null},[]),x=(0,y.useCallback)(()=>{if(f.current||null===d.current)return;f.current=!0;let e=performance.now()-d.current;v.trackMembersListReady(e),d.current=null},[]),S=(0,y.useMemo)(()=>({markEditorReady:m,markMessageSent:p,markFirstTokenReceived:g,markProjectConversationsReady:_,markMembersListReady:x}),[m,p,g,_,x]);return(0,a.jsx)(b.Provider,{value:S,children:t})}function x(){let e=(0,y.useContext)(b);if(!e)throw Error("usePerformanceMetrics must be used within a PerformanceMetricsProvider");return e}},85644:(e,t,n)=>{n.d(t,{A9:()=>d,Wq:()=>f,fC:()=>u});var a=n(77186),r=n(1761),i=n(71473),s=n(27062),o=n(85544);let l={image_in:!0,pdf_in:!1},u=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,{data:s,isLoading:o,isPlaceholderData:u}=(0,a.Sk)("/api/organizations/".concat(n,"/model_configs/").concat(e),{queryKey:[i.yV,n,e],enabled:!!n,staleTime:3e5,meta:{noToast:!0}});return{isLoading:o,modelConfig:!u&&s||l}},c=[],d=()=>{var e;let{value:t}=(0,s.fS)("backend_model_config"),{activeOrganization:n}=(0,r.YL)(),a=(0,s.T9)("claude_ai_models","models",c,o.KQ),i=t?null!=(e=null==n?void 0:n.claude_ai_bootstrap_models_config)?e:c:a,l=i.filter(e=>!e.inactive),u=l.filter(e=>!e.overflow),d=l.filter(e=>e.overflow);return{allModelOptions:i,activeModelOptions:l,mainModels:u,overflowModels:d}},f=()=>{let{allModelOptions:e}=d();return(t,n)=>{let a=e.find(e=>e.model===t);if(!a)return!1;let r=null==a?void 0:a.capabilities;return!r||!1!==r[n]}}},89836:(e,t,n)=>{n.d(t,{EF:()=>g,NY:()=>f,Ql:()=>h,VA:()=>v,YO:()=>p,qJ:()=>m});var a=n(77186),r=n(1761),i=n(46612),s=n(71473),o=n(77101),l=n(87606),u=n(7620),c=n(91768),d=n(93049);let f=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,i=!!(t&&e.length>0),o=(0,u.useMemo)(()=>e.map(e=>"/api/organizations/".concat(n,"/sync/chat/").concat(e)),[n,e]),l=(0,u.useMemo)(()=>({queryKey:e.map(e=>[s.GC,{orgUuid:n,syncSourceUuid:e}]),enabled:i,refetchInterval:e=>!!(e.state.data&&(0,c.z3)(e.state.data))&&5e3,meta:{noToast:!0}}),[i,n,e]);return(0,a._i)(o,l)},m=e=>!!e.some(e=>e.isLoading)||e.some(e=>e.data&&(0,c.z3)(e.data)),p=e=>Math.ceil(f(e).reduce((e,t)=>{var n,a,r;return t.isLoading||!t.data?e:e+(null!=(r=null==(a=t.data)||null==(n=a.status)?void 0:n.current_size_bytes)?r:0)},0)/i.t2),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:n}=(0,r.YL)(),i=null==t?void 0:t.uuid,u=null==n?void 0:n.uuid,f=(0,l.useQueryClient)(),m=(0,c.eL)();return(0,a.L2)(()=>"/api/organizations/".concat(u,"/sync/chat"),"POST",{enabled:!!n,...e,onSuccess:function(){for(var t,n,a,r,l,c=arguments.length,d=Array(c),m=0;m<c;m++)d[m]=arguments[m];let[p]=d;f.setQueryData([s.GC,{orgUuid:u,syncSourceUuid:p.uuid}],p),p.type===o.v8.GDRIVE&&p.config.uri&&(null==(t=p.status)?void 0:t.extra)&&(null==(n=p.status)?void 0:n.current_size_bytes)&&f.setQueryData([s.QB,{accountUUID:i,orgUUID:u,documentId:p.config.uri}],{uri:"drive:///".concat(p.config.uri),title:null==(r=p.status)?void 0:r.extra,size:null==(l=p.status)?void 0:l.current_size_bytes}),null==(a=e.onSuccess)||a.call(e,...d)},onError:function(){for(var t,n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];null==(t=e.onError)||t.call(e,...a);let[i,s]=a;m(i,s),s.sync_source_type===o.v8.GDRIVE&&(0,d.D8)(s.sync_source_config.uri)}})},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,i=(0,l.useQueryClient)();return(0,a.L2)(()=>"/api/organizations/".concat(n,"/sync/chat"),"PUT",{enabled:!!t,...e,onSuccess:function(){for(var t,a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];let[l]=r;i.setQueryData([s.GC,{orgUuid:n,syncSourceUuid:l.uuid}],l),null==(t=e.onSuccess)||t.call(e,...r)}})},h=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,a.L2)(e=>"/api/organizations/".concat(t,"/sync/chat/").concat(e),"DELETE",{enabled:!!e})}},93049:(e,t,n)=>{n.d(t,{Ac:()=>i,D8:()=>o,bI:()=>s});let a="recentDriveDocs";function r(e){return"object"==typeof e&&null!==e&&"string"==typeof e.uri&&("string"==typeof e.title||void 0===e.title)}function i(e){localStorage.setItem(a,JSON.stringify(e))}function s(){if("undefined"==typeof localStorage)return[];let e=localStorage.getItem(a);if(e){let t=JSON.parse(e);if(t&&Array.isArray(t)&&t.every(r))return t}return[]}function o(e){let t=s();i(t=t.filter(t=>t.uri!==e))}}}]);