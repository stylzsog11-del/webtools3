try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="209cf02e-bb4a-430b-a9f3-cac66cfe59ad",e._sentryDebugIdIdentifier="sentry-dbid-209cf02e-bb4a-430b-a9f3-cac66cfe59ad")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2947],{20878:(e,n,t)=>{t.d(n,{W:()=>r});var a=t(68096),i=t(1761),l=t(7620);function r(){let{mutate:e,isPending:n}=(0,a.Jy)(),{account:t}=(0,i.YL)();return{dismiss:(0,l.useCallback)(n=>{var a,i,l;t&&(null!=t&&null!=(i=t.settings)&&null!=(a=i.dismissed_claudeai_banners)&&a.some(e=>e.banner_id===n)||e({...t.settings,dismissed_claudeai_banners:[...(null==t||null==(l=t.settings)?void 0:l.dismissed_claudeai_banners)||[],{banner_id:n,dismissed_at:new Date().toISOString()}]}))},[t,e]),isDismissed:(0,l.useCallback)(e=>{var n,a;return(null==t||null==(a=t.settings)||null==(n=a.dismissed_claudeai_banners)?void 0:n.some(n=>n.banner_id===e))||!1},[t]),isPending:n}}},45078:(e,n,t)=>{t.d(n,{rX:()=>h,v2:()=>m,vP:()=>f});var a=t(68096),i=t(7726),l=t(98518),r=t(1761),o=t(27062),u=t(77101),s=t(85544),c=t(60098),d=t(75973),v=t(1524),g=t(85717),_=t(57934),p=t(45715);let m=()=>{let{initGithubAuth:e}=(0,_.nB)(),{initDriveAuth:n}=(0,g.cI)();return t=>{t===u.v8.GITHUB?e():t===u.v8.GDRIVE?n():t===u.v8.OUTLINE&&(0,p.so)()}},b=()=>{let{value:e}=(0,o.fS)("claudeai_paprika_sticky"),n=["enabled_web_search","enabled_bananagrams","enabled_sourdough","enabled_foccacia","enabled_mcp_tools"];return e&&n.push("paprika_mode"),n},f=e=>{let{conversation:n,pendingConversationSettings:t}=(0,c.o)(),{account:a}=(0,r.YL)(),i=b();if((0,v.R)(),n){var l;return null==(l=n.conversationSettings)?void 0:l[e]}return i.includes(e)?null==a?void 0:a.settings[e]:null==t?void 0:t[e]},h=()=>{let{conversation:e,setPendingConversationSettings:n}=(0,c.o)(),{account:t}=(0,r.YL)(),o=b(),{isInBeam:u,beamConversationSettings:v,setBeamConversationSettings:g}=(0,d.d)(),{track:_}=(0,l.st)(),{mutate:p}=(0,a.Jy)(),{mutate:m}=(0,i.HF)(null==e?void 0:e.id),f=a=>{if(!t)return;e?m({settings:{...a}}):u&&g&&g({...v,...a});let i={},l=!1;Object.keys(a).forEach(t=>{let r=a[t];o.includes(t)?(Object.assign(i,{[t]:r}),l=!0):s.W$.includes(t)&&!e&&n({[t]:r}),_({event_key:"claudeai.conversation.setting.toggled",conversation_uuid:(null==e?void 0:e.id)||null,setting:t,value:r})}),l&&p({...t.settings,...i})};return{toggleConversationSetting:(e,n)=>{f({[e]:n})},batchToggleConversationSettings:f}}},45564:(e,n,t)=>{t.d(n,{Q:()=>u,t:()=>s});var a=t(54568),i=t(89256),l=t.n(i),r=t(7620);let o=(0,r.createContext)({isOpen:!1,dropdownToOpen:void 0,openModal:l(),closeModal:l(),clearCallerIdentifier:l()}),u=e=>{let{children:n}=e,[t,i]=(0,r.useState)(!1),l=(0,r.useRef)(void 0),[u,s]=(0,r.useState)(void 0);return(0,a.jsx)(o.Provider,{value:{isOpen:t,openModal:e=>{i(!0),l.current=e},closeModal:()=>{i(!1),s(l.current)},dropdownToOpen:u,clearCallerIdentifier:()=>{s(void 0)}},children:n})},s=()=>(0,r.useContext)(o)},45715:(e,n,t)=>{t.d(n,{AI:()=>s,I5:()=>c,n0:()=>u,qp:()=>d,so:()=>v});var a=t(77186),i=t(1761),l=t(71473);t(77101);var r=t(87606);t(7620);var o=t(91768);let u=e=>{let{uri:n}=e,{data:t,isLoading:r}=(e=>{let{documentId:n}=e,{account:t,activeOrganization:r}=(0,i.YL)(),o=null==t?void 0:t.uuid,u=null==r?void 0:r.uuid,c=s();return(0,a.Sk)("/api/organizations/".concat(u,"/sync/mcp/outline/document/").concat(n),{queryKey:[l.hq,{accountUUID:o,orgUUID:u,documentId:n}],enabled:c})})({documentId:n});return{title:null==t?void 0:t.title,isLoading:r}},s=()=>{let{data:e}=(0,o.LN)();return!1},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,i.YL)(),r=null==t?void 0:t.uuid,o=s(),{data:u,refetch:c}=(0,a.Sk)("/api/organizations/".concat(r,"/sync/mcp/outline/auth"),{queryKey:[l.iP,{accountUUID:null==n?void 0:n.uuid,orgUUID:r}],enabled:!!(t&&o),staleTime:5e3}),{mutate:d,isPending:v}=(0,a.L2)("/api/organizations/".concat(r,"/sync/mcp/outline/auth/start"),"POST",{enabled:!!(t&&o),...e,onSuccess:function(){for(var n,t=arguments.length,a=Array(t),i=0;i<t;i++)a[i]=arguments[i];null==(n=e.onSuccess)||n.call(e,...a)}});return{isOutlineAuthenticated:!!(null==u?void 0:u.is_authenticated),refetch:c,initOutlineAuth:d,isLoadingOutlineAuthInit:v}},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,i.YL)(),o=null==n?void 0:n.uuid,u=null==t?void 0:t.uuid,c=s(),d=(0,r.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(u,"/sync/mcp/outline/auth"),"DELETE",{enabled:!!(t&&c),...e,onSuccess:function(){for(var n,t=arguments.length,a=Array(t),i=0;i<t;i++)a[i]=arguments[i];d.invalidateQueries({queryKey:[l.iP,{accountUUID:o,orgUUID:u}]}),null==(n=e.onSuccess)||n.call(e,...a)}})},v=()=>{let e=encodeURIComponent(window.location.href);window.location.href="/settings/connectors?redirect_url=".concat(e,"&open_outline_auth=true")}},57934:(e,n,t)=>{t.d(n,{nw:()=>S,I:()=>y,tn:()=>L,nB:()=>p,rW:()=>m,Cq:()=>b,b4:()=>f,yL:()=>h});var a=t(77186),i=t(1761),l=t(71473),r=t(77101),o=t(90119),u=t(87606),s=t(62942),c=t(7620);async function d(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{fallbackDelayMs:t=1e3,allowedDomains:a=[]}=n;if(!function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{let t=new URL(e,window.location.origin);if(t.origin===window.location.origin)return!0;if(n.length>0)return"https:"===t.protocol&&n.some(e=>t.hostname===e||t.hostname.endsWith(".".concat(e)));return!1}catch(e){return!1}}(e,a))throw Error("Invalid redirect URL: ".concat(e));try{let n=window.open(e,"_blank","noopener,noreferrer");if(!n||n.closed||void 0===n.closed)return await new Promise(e=>setTimeout(e,t)),window.location.href=e,!1;return!0}catch(n){return await new Promise(e=>setTimeout(e,t)),window.location.href=e,!1}}var v=t(91768),g=t(40459);let _="github_success",p=function(){var e;let{callerIdentifier:n,toggleGithubModalOpen:t,fetchImmediately:r=!1,pathname:u,queryString:g}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:p}=(0,i.YL)(),m=null==p?void 0:p.uuid,f=b(),[h,y]=(0,c.useState)(r),S=(e=>{let{shouldFetch:n=!1}=e,{activeOrganization:t}=(0,i.YL)(),r=null==t?void 0:t.uuid,o=b();return(0,a.Sk)("/api/organizations/".concat(r,"/sync/github/auth"),{queryKey:[l.Hv,{orgUUID:r}],enabled:!!(n&&t&&o)})})({shouldFetch:h}),L=(0,c.useCallback)(async()=>{var e,n;return h?null==(n=S.data)?void 0:n.is_authenticated:(y(!0),null==(e=(await S.refetch()).data)?void 0:e.is_authenticated)},[S,h]),{mutate:w}=(0,a.L2)("/api/organizations/".concat(m,"/sync/github/auth/start"),"POST",{enabled:!!(p&&f),onSuccess:e=>{d(e.redirect_url,{allowedDomains:["github.com","api.github.com"]})}}),I="".concat(_,"=").concat(n).concat(g?"&".concat(g):"");(0,v.FZ)({callerIdentifier:n,successParam:_,handleOpen:()=>{null==t||t(!0)}});let E=(0,s.useSearchParams)(),T=(0,o.V)(),A=(0,c.useRef)(!1),k=(0,s.usePathname)(),C=(0,v.dH)({pathname:u||k,searchParams:E,queryString:I,isClaudeApp:T});return{checkIsGithubAuthenticated:L,initGithubAuth:()=>{if(f){if(T)return void window.open("/settings/connectors?open_in_browser=1&auth_start=github&origin=".concat(C));A.current||(A.current=!0,w({pre_auth_state:{origin:C}}))}},isGithubAuthenticated:null==(e=S.data)?void 0:e.is_authenticated,isLoading:S.isLoading}},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,i.YL)(),t=null==n?void 0:n.uuid,r=b(),o=(0,u.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/sync/github/auth"),"DELETE",{enabled:!!(n&&r),...e,onSuccess:function(){for(var n,a=arguments.length,i=Array(a),r=0;r<a;r++)i[r]=arguments[r];o.invalidateQueries({queryKey:[l.Hv,{orgUUID:t}]}),null==(n=e.onSuccess)||n.call(e,...i)}})},b=()=>{let{data:e}=(0,v.LN)(),n=(0,i.mV)(),t=!!(Array.isArray(e)&&e.find(e=>e.type===r.v8.GITHUB&&e.enabled));return!!(!g.env.NEXT_PUBLIC_DISABLE_GITHUB_INTEGRATION&&(!n||t))},f=()=>{let{activeOrganization:e}=(0,i.YL)(),n=null==e?void 0:e.uuid,t=b();return(0,a.Sk)("/api/organizations/".concat(n,"/sync/github/repos"),{queryKey:[l.jL,{orgUUID:n}],enabled:!!(e&&t),meta:{noToast:!0}})},h=()=>{let{activeOrganization:e}=(0,i.YL)(),n=null==e?void 0:e.uuid,t=b();return(0,a.Sk)("/api/organizations/".concat(n,"/code/repos"),{queryKey:["SYNC_GH_REPOS_WITH_STATUS_QUERY_KEY",{orgUUID:n}],enabled:!!(e&&n&&t),meta:{noToast:!0}})},y=e=>{var n,t;return(null==(n=e.status)?void 0:n.workflow_enabled)===!0&&(null==(t=e.status)?void 0:t.app_installed)===!0},S=e=>!!e&&0!==e.length&&e.some(y),L=e=>{var n;let{owner:t,repo:r,branch:o}=e,u=(e=>{let{owner:n,repo:t,branch:r}=e,{activeOrganization:o}=(0,i.YL)(),u=null==o?void 0:o.uuid,s=b(),c=new URLSearchParams({owner:null!=n?n:"",repo:null!=t?t:""}).toString();return(0,a.Sk)("/api/organizations/".concat(u,"/sync/github/repo?").concat(c),{queryKey:[l.yB,{orgUUID:u,owner:n,repo:t}],enabled:!!(n&&t&&!r&&o&&s),meta:{noToast:!0}})})({owner:t,repo:r,branch:o}),s=(e=>{let{owner:n,repo:t,branch:r}=e,{activeOrganization:o}=(0,i.YL)(),u=null==o?void 0:o.uuid,s=b();return(0,a.Sk)("/api/organizations/".concat(u,"/sync/github/repo/").concat(n,"/").concat(t,"/tree/").concat(r),{queryKey:[l.o6,{orgUUID:u,owner:n,repo:t,branch:r}],staleTime:3e5,enabled:!!(n&&t&&r&&o&&s),meta:{noToast:!0}})})({owner:t,repo:r,branch:o||(null==(n=u.data)?void 0:n.default_branch)});return{data:{repo:u.data,tree:s.data},isFetching:u.isFetching||s.isFetching,error:u.error||s.error}}},85717:(e,n,t)=>{t.d(n,{$f:()=>R,K6:()=>P,L5:()=>q,LP:()=>I,U5:()=>A,cI:()=>T,ef:()=>K,fb:()=>z,kJ:()=>E,qL:()=>Y,vT:()=>O,y:()=>k,yy:()=>L,zF:()=>C,zH:()=>D});var a=t(68096),i=t(77186),l=t(1761),r=t(51121),o=t(71473),u=t(27062),s=t(77101),c=t(90119),d=t(21036),v=t(87606),g=t(62942),_=t(7620),p=t(46760),m=t(98251),b=t(45564),f=t(93049),h=t(91768),y=t(40459);let S="gdrive_success",L=()=>{let e=(0,l.mV)(),{data:n}=(0,h.LN)(),t=!!(Array.isArray(n)&&n.find(e=>e.type===s.v8.GDRIVE&&e.enabled));return!e||t},w=()=>{let{value:e}=(0,u.fS)("kingfisher_enabled"),n=(0,d.useLayer)("trials_freemium").get("free_integrations",!1);return e||n},I=()=>{let e=L(),n=w();return!!(!y.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION&&n&&e)},E=()=>{let{account:e,activeOrganization:n}=(0,l.YL)(),t=null==n?void 0:n.uuid,a=I(),{data:r,isFetched:u}=(0,i.Sk)("/api/organizations/".concat(t,"/sync/mcp/drive/auth"),{queryKey:[o.jR,{accountUUID:null==e?void 0:e.uuid,orgUUID:t}],enabled:a,staleTime:3e5});return{isAuthenticated:a&&!!(null==r?void 0:r.is_authenticated),isFetched:u}},T=function(){let{callerIdentifier:e,handleAuthSuccess:n,pathname:t,queryString:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isAuthenticated:u,isFetched:s}=E(),{addSuccess:d}=(0,r.Y)(),m=(0,p.A)(),{dropdownToOpen:f,clearCallerIdentifier:y}=(0,b.t)(),L=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null==n||n(e),d(m.formatMessage({defaultMessage:"Successfully connected to Google Drive",id:"7RI6njc31e"}))},w=(e=>{let{callerIdentifier:n,pathname:t,queryString:a}=e,r=(0,g.usePathname)(),{account:u,activeOrganization:s}=(0,l.YL)(),d=null==u?void 0:u.uuid,p=null==s?void 0:s.uuid,m=I(),b=(0,v.useQueryClient)(),f=(0,c.V)(),y=(0,g.useSearchParams)(),{mutate:L}=(0,i.L2)("/api/organizations/".concat(p,"/sync/mcp/drive/auth/start"),"POST",{enabled:m,onSuccess:e=>{window.location.href=e.redirect_url}}),w=(0,_.useRef)(!1);return()=>{if(!m)return;let e="".concat(S,"=").concat(n).concat(a?"&".concat(a):""),i=(0,h.dH)({pathname:t||r,searchParams:y,queryString:e,isClaudeApp:f});if(b.invalidateQueries({queryKey:[o.jR,{accountUUID:d,orgUUID:p}]}),f)return void window.open("/settings/connectors?open_in_browser=1&auth_start=gdrive&origin=".concat(i));w.current||(w.current=!0,L({pre_auth_state:{origin:i},redirect_uri:new URL("/connect/mcp/drive/callback",window.location.origin).toString()}))}})({callerIdentifier:e,pathname:t,queryString:a});return(0,h.FZ)({callerIdentifier:e,successParam:S,handleOpen:L}),(0,_.useEffect)(()=>{e&&f===e&&(null==n||n(!0),y())},[f,n,e,y]),{isDriveAuthenticated:u,initDriveAuth:w,handleDriveTrigger:L,isFetched:s}},A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,l.YL)(),a=null==n?void 0:n.uuid,r=null==t?void 0:t.uuid,u=I(),s=(0,v.useQueryClient)(),{mutate:c}=(0,m.ih)();return(0,i.L2)("/api/organizations/".concat(r,"/sync/mcp/drive/auth"),"DELETE",{enabled:!!(t&&u),...e,onSuccess:function(){for(var n,t=arguments.length,i=Array(t),l=0;l<t;l++)i[l]=arguments[l];s.invalidateQueries({queryKey:[o.jR,{accountUUID:a,orgUUID:r}]}),c({}),null==(n=e.onSuccess)||n.call(e,...i)}})},k=e=>{let{documentId:n}=e,{account:t,activeOrganization:a}=(0,l.YL)(),r=null==t?void 0:t.uuid,u=null==a?void 0:a.uuid,s=I(),c=(0,v.useQueryClient)(),d=(0,i.Sk)("/api/organizations/".concat(u,"/sync/mcp/drive/document/").concat(n,"?include_content=false"),{queryKey:[o.QB,{accountUUID:r,orgUUID:u,documentId:n}],enabled:s,meta:{noToast:!0}}),g=d.isError;return(0,_.useEffect)(()=>{g&&c.invalidateQueries({queryKey:[o.jR,{accountUUID:r,orgUUID:u}]})},[c,g,r,u]),d};function C(e){let{uri:n}=e,{data:t,isLoading:a}=k({documentId:n});return{title:null==t?void 0:t.title,isLoading:a}}let Y=e=>{let{account:n,activeOrganization:t}=(0,l.YL)(),a=null==n?void 0:n.uuid,r=null==t?void 0:t.uuid,u=I(),s=(0,_.useMemo)(()=>e.map(e=>"/api/organizations/".concat(r,"/sync/mcp/drive/document/").concat(e)),[e,r]),c=(0,_.useMemo)(()=>({queryKey:e.map(e=>[o.qM,{accountUUID:a,orgUUID:r,documentId:e}]),enabled:u,meta:{noToast:!0}}),[e,a,r,u]);return(0,i._i)(s,c)},D=e=>{let{account:n,activeOrganization:t}=(0,l.YL)(),a=null==n?void 0:n.uuid,r=null==t?void 0:t.uuid,u=I(),s=(0,f.bI)(),{data:c,isSuccess:d,isLoading:v}=(0,i.Sk)("/api/organizations/".concat(r,"/sync/mcp/drive/recents"),{queryKey:[o.zu,{accountUUID:a,orgUUID:r}],enabled:e&&u,meta:{noToast:!0}});return(0,_.useEffect)(()=>{if(d&&c){let e=c.map(e=>{let{uri:n,title:t}=e;return{uri:n,title:t}});(0,f.Ac)(e)}},[d,c]),{recentDriveDocs:d?c:s,isLoading:v}},z=()=>{let e=w(),{value:n}=(0,u.fS)("apps_use_bananagrams"),t=(0,d.useLayer)("trials_freemium").get("free_integrations",!1);return e&&n||t},P=()=>{let e=I(),n=z();return e&&n&&!y.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION},R=e=>{var n;let t=P(),{account:a}=(0,l.YL)();return!!t&&(e?!!(null==e||null==(n=e.conversationSettings)?void 0:n.enabled_bananagrams):!!(null==a?void 0:a.settings.enabled_bananagrams))},q=()=>(0,u.fS)("rag_prototype").value,O=()=>{let e=P(),n=(0,l.mV)(),{data:t}=(0,h.LN)(),{account:a}=(0,l.YL)(),i=q();return!!e&&!!i&&(n?!!(Array.isArray(t)&&t.find(e=>{var n;return e.type===s.v8.GDRIVE&&e.enabled&&(null==(n=e.config)?void 0:n.allow_indexing)})):!!(null==a?void 0:a.settings.enabled_gdrive_indexing))},K=()=>{let{account:e}=(0,l.YL)(),{mutate:n}=(0,a.Jy)(),{mutate:t}=(0,m.Bg)();return{toggleDriveSearchAndIndexingEnabled:a=>{var i;let{indexingEnabled:l,searchEnabled:r,dismissBanner:o}=a,u=o||!!l;l&&t({}),n({...null==e?void 0:e.settings,...void 0!==l?{enabled_gdrive_indexing:l}:null,...void 0!==r||!0===l?{enabled_bananagrams:null!=l?l:r}:null,...u?{dismissed_claudeai_banners:[...(null==e||null==(i=e.settings)?void 0:i.dismissed_claudeai_banners)||[],{banner_id:"drive_indexing_enablement_2/11_1",dismissed_at:new Date().toISOString()}]}:null})}}}},92947:(e,n,t)=>{t.d(n,{$V:()=>A,Ic:()=>S,Hj:()=>K,Cc:()=>q,Ib:()=>P,vx:()=>E,kX:()=>T,QD:()=>Y,HJ:()=>I,gt:()=>L,sb:()=>w,BN:()=>C,M8:()=>z,ko:()=>k,AY:()=>D,es:()=>R}),t(98878);var a=t(68096),i=t(7726),l=t(98518),r=t(1761),o=t(65631),u=t(27062),s=t(90119),c=t(97136),d=t.n(c),v=t(62942),g=t(7620),_=t(75006),p=t(20878),m=t(60098),b=t(21036),f=t(75973),h=t(45078),y=t(91768);let S=(0,g.createContext)({mcpClients:{},servers:[],mcpTools:[],isLoading:!1,isEnabled:!1}),L=()=>{let e=(0,g.useContext)(S);return e||console.warn("useMcp being used outside of McpProvider, this is probably a bug"),e},w=()=>{let{value:e}=(0,u.fS)("bagel_enabled");return e},I=()=>{let{value:e}=(0,u.fS)("inline_tool_approval");return e},E=()=>{let{account:e,activeOrganization:n}=(0,r.YL)(),t=(0,r.mV)(),a=(0,o.pG)(e,n,"claude-ai"),i=(0,o.yI)(e,n,o.Nt.IntegrationsManage);return!t||a||i},T=()=>{let e=(0,r.zm)(),n=E();return e&&!n},A="mcp_directory_chin",k=function(){var e,n;let{shouldTrack:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,g.useRef)(!1),i=w(),{dismiss:l}=(0,p.W)(),{account:o}=(0,r.YL)(),u=T(),s=new Date,c="".concat(s.getDate(),"-").concat(s.getMonth(),"-").concat(s.getFullYear()),d="".concat(A,"_").concat(c),v=(null!=(n=null==o||null==(e=o.settings.dismissed_claudeai_banners)?void 0:e.map(e=>e.banner_id))?n:[]).filter(e=>e.includes(A)),_=(0,g.useMemo)(()=>!(!i||u||v.includes(A))&&(!(v.length>3)||!v.includes(d)),[u,i,v,d]);return(0,g.useEffect)(()=>{!a.current&&_&&!v.includes(d)&&t&&(l(d),a.current=!0)},[d,v,t,l,_]),_},C=()=>{let{getMcpToolApprovalRequestSetting:e}=function(){let{value:e}=(0,b.useDynamicConfig)("mcp_tool_approval_config"),n=(0,g.useCallback)((n,t,a)=>{var i,l,r,o;return e?(null==(i=e[n])?void 0:i[t])!==void 0?e[n][t]:(null==(l=e[n])?void 0:l["*"])!==void 0?e[n]["*"]:(null==(r=e["*"])?void 0:r[t])!==void 0?e["*"][t]:(null==(o=e["*"])?void 0:o["*"])!==void 0?e["*"]["*"]:a:a},[e]);return{toolApprovalConfig:e,getMcpToolApprovalRequestSetting:n}}();return{getApprovalSetting:(0,g.useCallback)((n,t)=>{var a;let i=e(null!=n?n:"",null!=(a=null==t?void 0:t.name)?a:"","perChat");return{approvalSetting:i,alwaysAllowEnabled:"perChat"===i}},[e])}},Y=function(){let{pathname:e,queryString:n=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,r.YL)(),a=(0,v.usePathname)(),i=(0,v.useSearchParams)(),o=(0,s.V)(),{track:c}=(0,l.st)();(0,u.fS)("claudeai_beam").value;let d="".concat("").concat((0,y.dH)({pathname:e||a,searchParams:i,queryString:n,isClaudeApp:o}));return e=>{let{uuid:n,url:a}=e;c({event_key:"claudeai.mcp.auth.init",uuid:n,url:a}),window.location.href="/api/organizations/".concat(null==t?void 0:t.uuid,"/mcp/start-auth/").concat(n,"?redirect_url=").concat(d,"&open_in_browser=1")}},D=()=>{let{servers:e}=L();return!!(0,s.V)()&&(e.filter(e=>{let{type:n}=e;return"local"===n})||[]).length>0},z=()=>{var e,n,t;let a=(0,m.o)(),i=(null==(e=a.pendingConversationSettings)?void 0:e.compass_mode)==="advanced"||(null==(t=a.conversation)||null==(n=t.conversationSettings)?void 0:n.compass_mode)==="advanced",{servers:l}=L(),r=(l.filter(e=>{let{type:n}=e;return"remote"===n})||[]).length>0;return i&&r},P=()=>{var e;let n=null!=(e=(0,h.vP)("enabled_mcp_tools"))?e:{};return(0,g.useMemo)(()=>Object.entries(n).filter(e=>{let[n,t]=e;return!!t}).map(e=>{let[n]=e;return n}),[n])},R=()=>{let{conversation:e}=(0,m.o)(),{account:n}=(0,r.YL)(),{isInBeam:t,beamConversationSettings:o,setBeamConversationSettings:u}=(0,f.d)(),{track:s}=(0,l.st)(),{mutate:c}=(0,a.Jy)(),{mutate:d}=(0,i.HF)(null==e?void 0:e.id);return{toggleMcpToolEnabled:(a,i,l)=>{if(!n)return;let r=Array.isArray(a)?a.reduce((e,n)=>({...e,[n]:i}),{}):{[a]:i};if(e){var v;d({settings:{enabled_mcp_tools:{...null==(v=e.conversationSettings)?void 0:v.enabled_mcp_tools,...r}}})}else t&&u&&u({...o,enabled_mcp_tools:{...(null==o?void 0:o.enabled_mcp_tools)||{},...r}});let g=n.settings.enabled_mcp_tools;c({...n.settings,enabled_mcp_tools:{...g,...r}}),s({event_key:"claudeai.mcp.tool.toggled",conversation_uuid:(null==e?void 0:e.id)||null,setting:a,value:i,url:l})},toggleMcpToolAlwaysApproved:(e,t)=>{if(!n)return;let a=n.settings.enabled_mcp_tools;c({...n.settings,enabled_mcp_tools:{...a,[e]:t}})}}};function q(e,n){return"".concat(e,":").concat(n)}let O=_.z.object({description:_.z.string().optional(),type:_.z.string().optional(),title:_.z.string().optional()}).optional();function K(e){let n=e.enabledKey,t=e.description||"",a=function(e){var n;let t=Object.entries((null==(n=e.inputSchema)?void 0:n.properties)||{}),a=[];for(let[e,n]of t){let{data:t}=O.safeParse(n),i=(null==t?void 0:t.description)||"";a.push([e,i])}return a.sort((e,n)=>e[0].localeCompare(n[0])).flat().join(",")}(e),i=d().createHash("md5").update("".concat(t,":").concat(a)).digest("hex");return"".concat(n,"-").concat(i)}}}]);